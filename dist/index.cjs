"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const R=require("react"),M={subscribers:[],historyPush(e){const{view:t,panel:r,modal:n,popout:o}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};this.changeState({view:e.hasOwnProperty("view")?e.view:t,panel:e.hasOwnProperty("panel")?e.panel:r,modal:e.hasOwnProperty("modal")?e.modal:n,popout:e.hasOwnProperty("popout")?e.popout:o})},changeState(e){try{window.history.pushState(e,""),this.dispatchChangeStateEvent()}catch(t){console.log("changeState err",t)}},dispatchChangeStateEvent(){this._trigerEvent("changestate",window.history.state)},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r}),e==="changestate"&&this._trigerEvent("init",!0)},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}};function Ot(e,t){for(let r in e)t(e[r],r)}function L(e,t){e.forEach(t)}function j(e,t){if(!e)throw Error(t)}function x({node:e=[],from:t,source:r,parent:n=t||r,to:o,target:l,child:a=o||l,scope:h={},meta:w={},family:d={type:"regular"},regional:S}={}){let u=oe(n),f=oe(d.links),c=oe(d.owners),i=[];L(e,p=>p&&V(i,p));let s={id:Dt(),seq:i,next:oe(a),meta:w,scope:h,family:{type:d.type||"crosslink",links:f,owners:c}};return L(f,p=>V(ce(p),s)),L(c,p=>V(fe(p),s)),L(u,p=>V(p.next,s)),S&&z&&lt(J(z),[s]),s}function nt(e,t,r){let n,o=D,l=null,a=b;if(e.target&&(t=e.params,r=e.defer,n=e.meta,o="page"in e?e.page:o,e.stack&&(l=e.stack),a=ae(e)||a,e=e.target),a&&b&&a!==b&&(b=null),Array.isArray(e))for(let i=0;i<e.length;i++)H("pure",o,P(e[i]),l,t[i],a,n);else H("pure",o,P(e),l,t,a,n);if(r&&!ie)return;let h,w,d,S,u,f,c={isRoot:ie,currentPage:D,scope:b,isWatch:ye,isPure:se};ie=0;e:for(;S=jt();){let{idx:i,stack:s,type:p}=S;d=s.node,D=u=s.page,b=ae(s),u?f=u.reg:b&&(f=b.reg);let O=!!u,C=!!b,_={fail:0,scope:d.scope};h=w=0;for(let v=i;v<d.seq.length&&!h;v++){let y=d.seq[v];if(y.order){let{priority:m,barrierID:g}=y.order,E=g?u?`${u.fullID}_${g}`:g:0;if(v!==i||p!==m){g?we.has(E)||(we.add(E),Ae(v,s,m,g)):Ae(v,s,m);continue e}g&&we.delete(E)}switch(y.type){case"mov":{let g,E=y.data;switch(E.from){case X:g=J(s);break;case"a":case"b":g=s[E.from];break;case"value":g=E.store;break;case"store":if(f&&!f[E.store.id])if(O){let k=ft(u,E.store.id);s.page=u=k,k?f=k.reg:C?(F(b,E.store,0,1,E.softRead),f=b.reg):f=void 0}else C&&F(b,E.store,0,1,E.softRead);g=ct(f&&f[E.store.id]||E.store)}switch(E.to){case X:s.value=g;break;case"a":case"b":s[E.to]=g;break;case"store":Wt(u,b,d,E.target).current=g}break}case"compute":let m=y.data;if(m.fn){ye=B(d,"op")==="watch",se=m.pure;let g=m.safe?(0,m.fn)(J(s),_.scope,s):Gt(_,m.fn,s);m.filter?w=!g:s.value=g,ye=c.isWatch,se=c.isPure}}h=_.fail||w}if(!h){let v=J(s),y=ae(s);if(L(d.next,m=>{H("child",u,m,s,v,y)}),y){B(d,"needFxCounter")&&H("child",u,y.fxCount,s,v,y),B(d,"storeChange")&&H("child",u,y.storeChange,s,v,y),B(d,"warnSerialize")&&H("child",u,y.warnSerializeNode,s,v,y);let m=y.additionalLinks[d.id];m&&L(m,g=>{H("child",u,g,s,v,y)})}}}ie=c.isRoot,D=c.currentPage,b=ae(c)}function kt(e,t){let r,n,o=e;if(t){let l=At(t);e.length===0?(r=l.path,n=l.fullName):(r=l.path.concat([e]),n=l.fullName.length===0?e:l.fullName+"/"+e)}else r=e.length===0?[]:[e],n=e;return{shortName:o,fullName:n,path:r}}function Y(e,...t){let r=st();if(r){let n=r.handlers[e];if(n)return n(r,...t)}}function A(e,t){let r=te({or:t,and:typeof e=="string"?{name:e}:e}),n=(a,...h)=>(Z(!B(n,"derived"),"call of derived event","createEvent"),Z(!se,"unit call from pure function","operators like sample"),D?((w,d,S,u)=>{let f=D,c=null;if(d)for(c=D;c&&c.template!==d;)c=W(c);Ye(c);let i=w.create(S,u);return Ye(f),i})(n,o,a,h):n.create(a,h)),o=st(),l=Object.assign(n,{graphite:x({meta:vt("event",n,r),regional:1}),create:a=>(nt({target:n,params:a,scope:b}),a),watch:a=>pt(n,a),map:a=>_e(n,Q,a,[N()]),filter:a=>_e(n,"filter",a.fn?a:a.fn,[N(xe,1)]),filterMap:a=>_e(n,"filterMap",a,[N(),Be(h=>!I(h),1)]),prepend(a){let h=A("* → "+n.shortName,{parent:W(n)});return Y("eventPrepend",P(h)),$e(h,n,[N()],"prepend",a),Kt(n,h),h}});return r!=null&&r.domain&&r.domain.hooks.event(l),l}function We(e,t,r,n){return Ht(r,t,"first argument"),j(T(n),"second argument should be a function"),Z(!B(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),L(Array.isArray(r)?r:[r],o=>{e.off(o),ue(e).set(o,dt(ht(o,e,"on",xt,n)))}),e}function at(e,t){let r=te(t),n=$t(e),o=A({named:"updates",derived:1});Y("storeBase",n);let l=n.id,a={subscribers:new Map,updates:o,defaultState:e,stateRef:n,getState(){let i,s=n;if(D){let p=D;for(;p&&!p.reg[l];)p=W(p);p&&(i=p)}return!i&&b&&(F(b,n,1),i=b),i&&(s=i.reg[l]),ct(s)},setState:i=>nt({target:a,params:i,defer:1,scope:b}),reset:(...i)=>(L(i,s=>We(a,".reset",s,()=>a.defaultState)),a),on:(i,s)=>We(a,".on",i,s),off(i){let s=ue(a).get(i);return s&&(s(),ue(a).delete(i)),a},map(i,s){let p,O;G(i)&&(p=i,i=i.fn),Z(I(s),"second argument of store.map","updateFilter");let C=a.getState();I(C)||(O=i(C,s));let _=at(O,{name:`${a.shortName} → *`,derived:1,and:p}),v=ht(a,_,Q,Ue,i);return zt(le(_),{type:Q,fn:i,from:n}),le(_).noInit=1,Y("storeMap",n,v),_},watch(i,s){if(!s||!Pe(i)){let p=pt(a,i);return Y("storeWatch",n,i)||i(a.getState()),p}return j(T(s),"second argument should be a function"),i.watch(p=>s(a.getState(),p))}},h=vt("store",a,r),w=a.defaultConfig.updateFilter;a.graphite=x({scope:{state:n,fn:w},node:[Be((i,s,p)=>(p.scope&&!p.scope.reg[n.id]&&(p.b=1),i)),It(n),Be((i,s,{a:p,b:O})=>!I(i)&&(i!==p||O),1),w&&N(Ue,1),de({from:X,target:n})],child:o,meta:h,regional:1});let d=B(a,"serialize"),S=B(a,"derived"),u=d==="ignore",f=!d||u?0:d,c=B(a,"sid");return c&&(u||Fe(a,"storeChange",1),n.sid=c,f&&(n.meta={...n==null?void 0:n.meta,serialize:f})),c||u||S||Fe(a,"warnSerialize",1),j(S||!I(e),"current state can't be undefined, use null instead"),lt(a,[o]),r!=null&&r.domain&&r.domain.hooks.store(a),S||(a.reinit=A(),a.reset(a.reinit)),a}let Bt=typeof Symbol<"u"&&Symbol.observable||"@@observable",Q="map",X="stack",P=e=>e.graphite||e,ce=e=>e.family.owners,fe=e=>e.family.links,le=e=>e.stateRef,J=e=>e.value,ue=e=>e.subscribers,W=e=>e.parent,ae=e=>e.scope,B=(e,t)=>P(e).meta[t],Fe=(e,t,r)=>P(e).meta[t]=r,At=e=>e.compositeName,Pe=e=>(T(e)||G(e))&&"kind"in e;const ne=e=>t=>Pe(t)&&t.kind===e;let Ve=ne("store"),Ct=ne("event"),Ge=ne("effect"),ot=ne("domain"),Rt=ne("scope");var Lt={__proto__:null,unit:Pe,store:Ve,event:Ct,effect:Ge,domain:ot,scope:Rt,attached:e=>Ge(e)&&B(e,"attached")==1};let ge=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},V=(e,t)=>e.push(t),Z=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const He=()=>{let e=0;return()=>""+ ++e};let Mt=He(),it=He(),Dt=He(),z=null,st=()=>z,Pt=e=>(e&&z&&z.sidRoot&&(e=`${z.sidRoot}|${e}`),e),lt=(e,t)=>{let r=P(e);L(t,n=>{let o=P(n);r.family.type!=="domain"&&(o.family.type="crosslink"),V(ce(o),r),V(fe(r),o)})},oe=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(P),G=e=>typeof e=="object"&&e!==null,T=e=>typeof e=="function",I=e=>e===void 0,Vt=e=>j(G(e)||T(e),"expect first argument be an object");const Ke=(e,t,r,n)=>j(!(!G(e)&&!T(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${n}`);let Ht=(e,t,r)=>{Array.isArray(e)?L(e,(n,o)=>Ke(n,t,`${o} item of ${r}`,"")):Ke(e,t,r," or array of units")},Ue=(e,{fn:t},{a:r})=>t(e,r),xt=(e,{fn:t},{a:r})=>t(r,e),xe=(e,{fn:t})=>t(e);const ut=(e,t,r,n)=>{let o={id:it(),type:e,data:t};return r&&(o.order={priority:r},n&&(o.order.barrierID=++Tt)),o};let Tt=0,de=({from:e="store",store:t,target:r,to:n=r?"store":X,batch:o,priority:l})=>ut("mov",{from:e,store:t,to:n,target:r},l,o),ee=({fn:e,batch:t,priority:r,safe:n=0,filter:o=0,pure:l=0})=>ut("compute",{fn:e,safe:n,filter:o,pure:l},r,t),Te=({fn:e})=>ee({fn:e,priority:"effect"}),Be=(e,t,r)=>ee({fn:e,safe:1,filter:t,priority:r&&"effect"}),It=(e,t,r)=>de({store:e,to:t?X:"a",priority:r&&"sampler",batch:1}),N=(e=xe,t)=>ee({fn:e,pure:1,filter:t}),Nt={mov:de,compute:ee,filter:({fn:e,pure:t})=>ee({fn:e,filter:1,pure:t}),run:Te},$t=e=>({id:it(),current:e}),ct=({current:e})=>e,zt=(e,t)=>{e.before||(e.before=[]),V(e.before,t)},$=null;const Ie=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Ce(e.v.type)>Ce(t.v.type))&&(r=e,e=t,t=r),r=Ie(e.r,t),e.r=e.l,e.l=r,e},Ne=[];let qe=0;for(;qe<6;)V(Ne,{first:null,last:null,size:0}),qe+=1;const jt=()=>{for(let e=0;e<6;e++){let t=Ne[e];if(t.size>0){if(e===3||e===4){t.size-=1;let n=$.v;return $=Ie($.l,$.r),n}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},H=(e,t,r,n,o,l,a)=>Ae(0,{a:null,b:null,node:r,parent:n,value:o,page:t,scope:l,meta:a},e),Ae=(e,t,r,n=0)=>{let o=Ce(r),l=Ne[o],a={v:{idx:e,stack:t,type:r,id:n},l:null,r:null};o===3||o===4?$=Ie($,a):(l.size===0?l.first=a:l.last.r=a,l.last=a),l.size+=1},Ce=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},we=new Set;let b,ie=1,ye=0,se=0,D=null,Ye=e=>{D=e};const ft=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=W(e);if(e)return e}return null};let Wt=(e,t,r,n,o)=>{let l=ft(e,n.id);return l?l.reg[n.id]:t?(F(t,n,o),t.reg[n.id]):n};const Ft=e=>e;let F=(e,t,r,n,o)=>{var l;let a=e.reg,h=t.sid,w=t==null||(l=t.meta)===null||l===void 0?void 0:l.serialize;if(a[t.id])return;let d={id:t.id,current:t.current,meta:t.meta};if(h&&h in e.sidValuesMap&&!(h in e.sidIdMap))d.current=(e.fromSerialize&&w!=="ignore"&&(w==null?void 0:w.read)||Ft)(e.sidValuesMap[h]);else if(t.before&&!o){let S=0,u=r||!t.noInit||n;L(t.before,f=>{switch(f.type){case Q:{let c=f.from;if(c||f.fn){c&&F(e,c,r,n);let i=c&&a[c.id].current;u&&(d.current=f.fn?f.fn(i):i)}break}case"field":S||(S=1,d.current=Array.isArray(d.current)?[...d.current]:{...d.current}),F(e,f.from,r,n),u&&(d.current[f.field]=a[a[f.from.id].id].current)}})}h&&(e.sidIdMap[h]=t.id),a[t.id]=d};const Gt=(e,t,r)=>{try{return t(J(r),e.scope,r)}catch(n){console.error(n),e.fail=1}};let te=(e,t={})=>(G(e)&&(te(e.or,t),Ot(e,(r,n)=>{I(r)||n==="or"||n==="and"||(t[n]=r)}),te(e.and,t)),t);const Je=(e,t)=>{ge(e.next,t),ge(ce(e),t),ge(fe(e),t)},Re=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let o=fe(e);for(;n=o.pop();)Je(n,e),(t||r&&B(e,"op")!=="sample"||n.family.type==="crosslink")&&Re(n,t,B(n,"op")!=="on"&&r);for(o=ce(e);n=o.pop();)Je(n,e),r&&n.family.type==="crosslink"&&Re(n,t,B(n,"op")!=="on"&&r)},q=e=>e.clear();let Le=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),Ve(e))q(ue(e));else if(ot(e)){r=1;let n=e.history;q(n.events),q(n.effects),q(n.stores),q(n.domains)}Re(P(e),!!t,r)},dt=e=>{let t=()=>Le(e);return t.unsubscribe=t,t},$e=(e,t,r,n,o)=>x({node:r,parent:e,child:t,scope:{fn:o},meta:{op:n},family:{owners:[e,t],links:t},regional:1}),pt=(e,t)=>(j(T(t),".watch argument should be a function"),dt(x({scope:{fn:t},node:[Te({fn:xe})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),Kt=(e,t,r="event")=>{W(e)&&W(e).hooks[r](t)},vt=(e,t,r)=>{let n=te(r),o=e==="domain",l=Mt(),{sid:a=null,named:h=null,domain:w=null,parent:d=w}=n,S=h||n.name||(o?"":l),u=kt(S,d),f={op:t.kind=e,name:t.shortName=S,sid:t.sid=Pt(a),named:h,unitId:t.id=l,serialize:n.serialize,derived:n.derived,config:n};return t.parent=d,t.compositeName=u,t.defaultConfig=n,t.thru=c=>(Z(0,"thru","js pipe"),c(t)),t.getType=()=>u.fullName,!o&&(t.subscribe=c=>(Vt(c),t.watch(T(c)?c:i=>c.next&&c.next(i))),t[Bt]=()=>t),f};const _e=(e,t,r,n)=>{let o;G(r)&&(o=r,r=r.fn);let l=A({name:`${e.shortName} → *`,derived:1,and:o});return $e(e,l,n,t,r),l},ht=(e,t,r,n,o)=>{let l=le(t),a=de({store:l,to:"a",priority:"read"});r===Q&&(a.data.softRead=1);let h=[a,N(n)];return Y("storeOnMap",l,h,Ve(e)&&le(e)),$e(e,t,h,r,o)};x({node:[Te({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}});const mt=A(),St=A(),gt=A(),ze=A(),je=A(),wt=A(),Ut=A(),Me=A(),De=A(),qt=e=>{e&&De({...e,isBackHandled:!1}),(!e||!e.hasOwnProperty("isBackFromBrowser"))&&De({isBackFromBrowser:!1}),window.history.back()},Yt=e=>{M.historyPush({view:e.view,panel:e.panel})},Jt=e=>{M.historyPush({panel:e})},Qt=e=>{M.historyPush({modal:e})},Xt=e=>{M.historyPush({popout:e})},Zt=at({activeView:null,activePanel:null,activeModal:null,activePopout:null,isRouteInit:!1,isBackHandled:!0,isDispatchChangeStateEventBeforeMiddleware:!1,isDispatchChangeStateEventAfterMiddleware:!0,beforeBackHandledCallback:null,afterBackHandledCallback:null,isBackFromBrowser:!0}).on(Me,e=>({...e,isDispatchChangeStateEventBeforeMiddleware:!1,isDispatchChangeStateEventAfterMiddleware:!0,beforeBackHandledCallback:null,afterBackHandledCallback:null,isBackFromBrowser:!0,isBackHandled:!0})).on(De,(e,t)=>({...e,isBackHandled:t.hasOwnProperty("isBackHandled")?t.isBackHandled:e.isBackHandled,isBackFromBrowser:t.hasOwnProperty("isBackFromBrowser")?t.isBackFromBrowser:e.isBackFromBrowser,isDispatchChangeStateEventBeforeMiddleware:t.hasOwnProperty("isDispatchChangeStateEventBeforeMiddleware")?t.isDispatchChangeStateEventBeforeMiddleware:e.isDispatchChangeStateEventBeforeMiddleware,isDispatchChangeStateEventAfterMiddleware:t.hasOwnProperty("isDispatchChangeStateEventAfterMiddleware")?t.isDispatchChangeStateEventAfterMiddleware:e.isDispatchChangeStateEventAfterMiddleware,beforeBackHandledCallback:t.hasOwnProperty("beforeBackHandledCallback")?t.beforeBackHandledCallback:e.beforeBackHandledCallback,afterBackHandledCallback:t.hasOwnProperty("afterBackHandledCallback")?t.afterBackHandledCallback:e.afterBackHandledCallback})).on(mt,(e,t)=>({...e,activeView:t})).on(St,(e,t)=>({...e,activePanel:t})).on(ze,(e,t)=>({...e,activeModal:t})).on(je,(e,t)=>({...e,activePopout:t})).on(wt,e=>({...e,isRouteInit:!0})).on(gt,(e,{view:t,panel:r})=>({...e,activeView:t,activePanel:r})).on(Ut,(e,t)=>({...e,isBackHandled:t}));function er(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Qe={},tr={get exports(){return Qe},set exports(e){Qe=e}},Ee={},re={},rr={get exports(){return re},set exports(e){re=e}},be={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe;function nr(){if(Xe)return be;Xe=1;var e=R;function t(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,o=e.useEffect,l=e.useLayoutEffect,a=e.useDebugValue;function h(u,f){var c=f(),i=n({inst:{value:c,getSnapshot:f}}),s=i[0].inst,p=i[1];return l(function(){s.value=c,s.getSnapshot=f,w(s)&&p({inst:s})},[u,c,f]),o(function(){return w(s)&&p({inst:s}),u(function(){w(s)&&p({inst:s})})},[u]),a(c),c}function w(u){var f=u.getSnapshot;u=u.value;try{var c=f();return!r(u,c)}catch{return!0}}function d(u,f){return f()}var S=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:h;return be.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:S,be}var Oe={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ze;function ar(){return Ze||(Ze=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=R,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(_){{for(var v=arguments.length,y=new Array(v>1?v-1:0),m=1;m<v;m++)y[m-1]=arguments[m];n("error",_,y)}}function n(_,v,y){{var m=t.ReactDebugCurrentFrame,g=m.getStackAddendum();g!==""&&(v+="%s",y=y.concat([g]));var E=y.map(function(k){return String(k)});E.unshift("Warning: "+v),Function.prototype.apply.call(console[_],console,E)}}function o(_,v){return _===v&&(_!==0||1/_===1/v)||_!==_&&v!==v}var l=typeof Object.is=="function"?Object.is:o,a=e.useState,h=e.useEffect,w=e.useLayoutEffect,d=e.useDebugValue,S=!1,u=!1;function f(_,v,y){S||e.startTransition!==void 0&&(S=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var m=v();if(!u){var g=v();l(m,g)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),u=!0)}var E=a({inst:{value:m,getSnapshot:v}}),k=E[0].inst,K=E[1];return w(function(){k.value=m,k.getSnapshot=v,c(k)&&K({inst:k})},[_,m,v]),h(function(){c(k)&&K({inst:k});var pe=function(){c(k)&&K({inst:k})};return _(pe)},[_]),d(m),m}function c(_){var v=_.getSnapshot,y=_.value;try{var m=v();return!l(y,m)}catch{return!0}}function i(_,v,y){return v()}var s=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",p=!s,O=p?i:f,C=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:O;Oe.useSyncExternalStore=C,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Oe}(function(e){process.env.NODE_ENV==="production"?e.exports=nr():e.exports=ar()})(rr);const or=er(re);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et;function ir(){if(et)return Ee;et=1;var e=R,t=re;function r(d,S){return d===S&&(d!==0||1/d===1/S)||d!==d&&S!==S}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,l=e.useRef,a=e.useEffect,h=e.useMemo,w=e.useDebugValue;return Ee.useSyncExternalStoreWithSelector=function(d,S,u,f,c){var i=l(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=h(function(){function O(m){if(!C){if(C=!0,_=m,m=f(m),c!==void 0&&s.hasValue){var g=s.value;if(c(g,m))return v=g}return v=m}if(g=v,n(_,m))return g;var E=f(m);return c!==void 0&&c(g,E)?g:(_=m,v=E)}var C=!1,_,v,y=u===void 0?null:u;return[function(){return O(S())},y===null?void 0:function(){return O(y())}]},[S,u,f,c]);var p=o(d,i[0],i[1]);return a(function(){s.hasValue=!0,s.value=p},[p]),w(p),p},Ee}var ke={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tt;function sr(){return tt||(tt=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=R,t=re;function r(S,u){return S===u&&(S!==0||1/S===1/u)||S!==S&&u!==u}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,l=e.useRef,a=e.useEffect,h=e.useMemo,w=e.useDebugValue;function d(S,u,f,c,i){var s=l(null),p;s.current===null?(p={hasValue:!1,value:null},s.current=p):p=s.current;var O=h(function(){var y=!1,m,g,E=function(U){if(!y){y=!0,m=U;var ve=c(U);if(i!==void 0&&p.hasValue){var he=p.value;if(i(he,ve))return g=he,he}return g=ve,ve}var bt=m,me=g;if(n(bt,U))return me;var Se=c(U);return i!==void 0&&i(me,Se)?me:(m=U,g=Se,Se)},k=f===void 0?null:f,K=function(){return E(u())},pe=k===null?void 0:function(){return E(k())};return[K,pe]},[u,f,c,i]),C=O[0],_=O[1],v=o(S,C,_);return a(function(){p.hasValue=!0,p.value=v},[v]),w(v),v}ke.useSyncExternalStoreWithSelector=d,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),ke}(function(e){process.env.NODE_ENV==="production"?e.exports=ir():e.exports=sr()})(tr);function lr(e,t,r,n){let o=[Nt.run({fn:l=>t(l)})];if(n&&o.unshift(n),r){let l=x({node:o}),a=e.graphite.id,h=r.additionalLinks,w=h[a]||[];return h[a]=w,w.push(l),()=>{let d=w.indexOf(l);d!==-1&&w.splice(d,1),Le(l)}}{let l=x({node:o,parent:[e],family:{owners:e}});return()=>{Le(l)}}}function ur(e,t){Lt.store(e)||yt("expect useStore argument to be a store");let r=R.useCallback(o=>lr(e,o,t),[e,t]),n=R.useCallback(()=>pr(e,t),[e,t]);return dr(r,n,n)}function cr(e){let t=R.useContext(vr);return e&&!t&&yt("No scope found, consider adding <Provider> to app root"),t}function fr(e,t){return ur(e,cr(t==null?void 0:t.forceScope))}let yt=e=>{throw Error(e)};typeof window<"u"?R.useLayoutEffect:R.useEffect;const{useSyncExternalStore:dr}=or,pr=(e,t)=>t?t.getState(e):e.getState(),vr=R.createContext(null),hr=(e,t,r)=>{R.useEffect(()=>{const n=o=>{o instanceof KeyboardEvent&&o.key===r?t(o):r||t(o)};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)},[e,r,t])},rt=(e,t,r,n)=>{R.useEffect(()=>(M.addEventListener(e,t,r),()=>M.removeEventListener(r)),[...n])},mr=(e,...t)=>{const{activeView:r,activePanel:n,activeModal:o,activePopout:l,isRouteInit:a,isDispatchChangeStateEventBeforeMiddleware:h,isDispatchChangeStateEventAfterMiddleware:w,isBackHandled:d,isBackFromBrowser:S,afterBackHandledCallback:u,beforeBackHandledCallback:f}=_t();rt("init",c=>{console.log("[blum]: initialized",c),a||(Me(),M.historyPush(e))},1,[a]),hr("popstate",async()=>{const c=async(i,s)=>{h&&M.dispatchChangeStateEvent();for(const p in t)if(!await t[p](i,s,{isBackHandled:d,isBackFromBrowser:S,isDispatchChangeStateEventAfterMiddleware:w,isDispatchChangeStateEventBeforeMiddleware:h,beforeBackHandledCallback:f,afterBackHandledCallback:u}))return;w&&M.dispatchChangeStateEvent()};if(a){const i=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0},s={view:r,panel:n,modal:o,popout:l};console.log("[blum]: prevRoutes",i),console.log("[blum]: storeRoutes",s),f&&f(s,i),await c(s,i),Me(),u&&u(s,i)}}),rt("changestate",c=>{if(console.log("[blum]: state changed",c),c){const{view:i,panel:s,modal:p,popout:O}=c;i&&s&&gt({view:i,panel:s}),ze(p),je(O),a||wt()}},2,[a])},_t=()=>fr(Zt),Sr=e=>e,gr=(e,t)=>Et(e,async(r,n,o)=>{let l;if(t&&(l=await t(r,n,o)),M.historyPush(r),typeof l=="boolean")return l}),Et=(e,t)=>async(r,n,o)=>{if(["view","panel","modal","popout"].some(a=>r[a]===e&&r[a]!==n[a])&&o.isBackFromBrowser){if(t){const a=await t(r,n,o);if(typeof a=="boolean")return a}return!1}return!0};exports._setActiveModal=ze;exports._setActivePanel=St;exports._setActivePopout=je;exports._setActiveView=mt;exports.back=qt;exports.blumRouter=M;exports.createCatchBackBrowserRouteMiddleware=Et;exports.createDisableBackBrowserRouteMiddleware=gr;exports.createRouteMiddleware=Sr;exports.setActiveModal=Qt;exports.setActivePanel=Jt;exports.setActivePopout=Xt;exports.setActiveViewPanel=Yt;exports.useInitRouter=mr;exports.useRouter=_t;
