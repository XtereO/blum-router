"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const k=require("react");function Ot(e,t){for(let r in e)t(e[r],r)}function V(e,t){e.forEach(t)}function I(e,t){if(!e)throw Error(t)}function B({node:e=[],from:t,source:r,parent:n=t||r,to:o,target:l,child:a=o||l,scope:v={},meta:_={},family:f={type:"regular"},regional:h}={}){let c=le(n),p=le(f.links),i=le(f.owners),s=[];V(e,d=>d&&C(s,d));let u={id:Ct(),seq:s,next:le(a),meta:_,scope:v,family:{type:f.type||"crosslink",links:p,owners:i}};return V(p,d=>C(he(d),u)),V(i,d=>C(Se(d),u)),V(c,d=>C(d.next,u)),h&&H&&Ne(ee(H),[u]),u}function re(e,t,r){let n,o=D,l=null,a=O;if(e.target&&(t=e.params,r=e.defer,n=e.meta,o="page"in e?e.page:o,e.stack&&(l=e.stack),a=P(e)||a,e=e.target),a&&O&&a!==O&&(O=null),Array.isArray(e))for(let s=0;s<e.length;s++)$("pure",o,T(e[s]),l,t[s],a,n);else $("pure",o,T(e),l,t,a,n);if(r&&!ce)return;let v,_,f,h,c,p,i={isRoot:ce,currentPage:D,scope:O,isWatch:de,isPure:pe};ce=0;e:for(;h=Wt();){let{idx:s,stack:u,type:d}=h;f=u.node,D=c=u.page,O=P(u),c?p=c.reg:O&&(p=O.reg);let b=!!c,A=!!O,w={fail:0,scope:f.scope};v=_=0;for(let m=s;m<f.seq.length&&!v;m++){let y=f.seq[m];if(y.order){let{priority:S,barrierID:g}=y.order,E=g?c?`${c.fullID}_${g}`:g:0;if(m!==s||d!==S){g?Ae.has(E)||(Ae.add(E),Me(m,u,S,g)):Me(m,u,S);continue e}g&&Ae.delete(E)}switch(y.type){case"mov":{let g,E=y.data;switch(E.from){case ae:g=ee(u);break;case"a":case"b":g=u[E.from];break;case"value":g=E.store;break;case"store":if(p&&!p[E.store.id])if(b){let R=ft(c,E.store.id);u.page=c=R,R?p=R.reg:A?(K(O,E.store,0,1,E.softRead),p=O.reg):p=void 0}else A&&K(O,E.store,0,1,E.softRead);g=ct(p&&p[E.store.id]||E.store)}switch(E.to){case ae:u.value=g;break;case"a":case"b":u[E.to]=g;break;case"store":Ht(c,O,f,E.target).current=g}break}case"compute":let S=y.data;if(S.fn){de=L(f,"op")==="watch",pe=S.pure;let g=S.safe?(0,S.fn)(ee(u),w.scope,u):Kt(w,S.fn,u);S.filter?_=!g:u.value=g,de=i.isWatch,pe=i.isPure}}v=w.fail||_}if(!v){let m=ee(u),y=P(u);if(V(f.next,S=>{$("child",c,S,u,m,y)}),y){L(f,"needFxCounter")&&$("child",c,y.fxCount,u,m,y),L(f,"storeChange")&&$("child",c,y.storeChange,u,m,y),L(f,"warnSerialize")&&$("child",c,y.warnSerializeNode,u,m,y);let S=y.additionalLinks[f.id];S&&V(S,g=>{$("child",c,g,u,m,y)})}}}ce=i.isRoot,D=i.currentPage,O=P(i)}function bt(e,t){let r,n,o=e;if(t){let l=Lt(t);e.length===0?(r=l.path,n=l.fullName):(r=l.path.concat([e]),n=l.fullName.length===0?e:l.fullName+"/"+e)}else r=e.length===0?[]:[e],n=e;return{shortName:o,fullName:n,path:r}}function Z(e,...t){let r=ut();if(r){let n=r.handlers[e];if(n)return n(r,...t)}}function x(e,t){let r=U({or:t,and:typeof e=="string"?{name:e}:e}),n=(a,...v)=>(oe(!L(n,"derived"),"call of derived event","createEvent"),oe(!pe,"unit call from pure function","operators like sample"),D?((_,f,h,c)=>{let p=D,i=null;if(f)for(i=D;i&&i.template!==f;)i=N(i);Xe(i);let s=_.create(h,c);return Xe(p),s})(n,o,a,v):n.create(a,v)),o=ut(),l=Object.assign(n,{graphite:B({meta:vt("event",n,r),regional:1}),create:a=>(re({target:n,params:a,scope:O}),a),watch:a=>pt(n,a),map:a=>Re(n,ne,a,[W()]),filter:a=>Re(n,"filter",a.fn?a:a.fn,[W(je,1)]),filterMap:a=>Re(n,"filterMap",a,[W(),F(v=>!q(v),1)]),prepend(a){let v=x("* → "+n.shortName,{parent:N(n)});return Z("eventPrepend",T(v)),Ge(v,n,[W()],"prepend",a),Ut(n,v),v}});return r!=null&&r.domain&&r.domain.hooks.event(l),l}function Ke(e,t,r,n){return It(r,t,"first argument"),I(M(n),"second argument should be a function"),oe(!L(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),V(Array.isArray(r)?r:[r],o=>{e.off(o),me(e).set(o,dt(mt(o,e,"on",Bt,n)))}),e}function Ie(e,t){let r=U(t),n=zt(e),o=x({named:"updates",derived:1});Z("storeBase",n);let l=n.id,a={subscribers:new Map,updates:o,defaultState:e,stateRef:n,getState(){let s,u=n;if(D){let d=D;for(;d&&!d.reg[l];)d=N(d);d&&(s=d)}return!s&&O&&(K(O,n,1),s=O),s&&(u=s.reg[l]),ct(u)},setState:s=>re({target:a,params:s,defer:1,scope:O}),reset:(...s)=>(V(s,u=>Ke(a,".reset",u,()=>a.defaultState)),a),on:(s,u)=>Ke(a,".on",s,u),off(s){let u=me(a).get(s);return u&&(u(),me(a).delete(s)),a},map(s,u){let d,b;j(s)&&(d=s,s=s.fn),oe(q(u),"second argument of store.map","updateFilter");let A=a.getState();q(A)||(b=s(A,u));let w=Ie(b,{name:`${a.shortName} → *`,derived:1,and:d}),m=mt(a,w,ne,Je,s);return qt(ve(w),{type:ne,fn:s,from:n}),ve(w).noInit=1,Z("storeMap",n,m),w},watch(s,u){if(!u||!Be(s)){let d=pt(a,s);return Z("storeWatch",n,s)||s(a.getState()),d}return I(M(u),"second argument should be a function"),s.watch(d=>u(a.getState(),d))}},v=vt("store",a,r),_=a.defaultConfig.updateFilter;a.graphite=B({scope:{state:n,fn:_},node:[F((s,u,d)=>(d.scope&&!d.scope.reg[n.id]&&(d.b=1),s)),Nt(n),F((s,u,{a:d,b})=>!q(s)&&(s!==d||b),1),_&&W(Je,1),_e({from:ae,target:n})],child:o,meta:v,regional:1});let f=L(a,"serialize"),h=L(a,"derived"),c=f==="ignore",p=!f||c?0:f,i=L(a,"sid");return i&&(c||te(a,"storeChange",1),n.sid=i,p&&(n.meta={...n==null?void 0:n.meta,serialize:p})),i||c||h||te(a,"warnSerialize",1),I(h||!q(e),"current state can't be undefined, use null instead"),Ne(a,[o]),r!=null&&r.domain&&r.domain.hooks.store(a),h||(a.reinit=x(),a.reset(a.reinit)),a}function At(){let e={};return e.req=new Promise((t,r)=>{e.rs=t,e.rj=r}),e.req.catch(()=>{}),e}function Y(e,t){let r=U(M(e)?{handler:e}:e,t),n=x(M(e)?{handler:e}:e,t),o=T(n);te(o,"op",n.kind="effect"),n.use=i=>(I(M(i),".use argument should be a function"),h.scope.handler=i,n),n.use.getCurrent=()=>h.scope.handler;let l=n.finally=x({named:"finally",derived:1}),a=n.done=l.filterMap({named:"done",fn({status:i,params:s,result:u}){if(i==="done")return{params:s,result:u}}}),v=n.fail=l.filterMap({named:"fail",fn({status:i,params:s,error:u}){if(i==="fail")return{params:s,error:u}}}),_=n.doneData=a.map({named:"doneData",fn:({result:i})=>i}),f=n.failData=v.map({named:"failData",fn:({error:i})=>i}),h=B({scope:{handlerId:L(o,"sid"),handler:n.defaultConfig.handler||(()=>I(0,`no handler used in ${n.getType()}`))},node:[F((i,s,u)=>{let d=s,b=d.handler;if(P(u)){let A=P(u).handlers[d.handlerId];A&&(b=A)}return i.handler=b,i},0,1),F(({params:i,req:s,handler:u,args:d=[i]},b,A)=>{let w=Jt(A),m=et(i,s,1,l,A,w),y=et(i,s,0,l,A,w),[S,g]=Yt(u,y,d);S&&(j(g)&&M(g.then)?g.then(m,y):m(g))},0,1)],meta:{op:"fx",fx:"runner"}});o.scope.runner=h,C(o.seq,F((i,{runner:s},u)=>{let d=N(u)?{params:i,req:{rs(b){},rj(b){}}}:i;return u.meta||(u.meta={fxID:Dt()}),re({target:s,params:d,defer:1,scope:P(u),meta:u.meta}),d.params},0,1)),n.create=i=>{let s=At(),u={params:i,req:s};if(O&&!de){let d=O;s.req.finally(()=>{Gt(d)}).catch(()=>{})}return re({target:n,params:u,scope:O}),s.req};let c=n.inFlight=Ie(0,{serialize:"ignore"}).on(n,i=>i+1).on(l,i=>i-1).map({fn:i=>i,named:"inFlight"});te(l,"needFxCounter","dec"),te(n,"needFxCounter",1);let p=n.pending=c.map({fn:i=>i>0,named:"pending"});return Ne(n,[l,a,v,_,f,p,c]),r!=null&&r.domain&&r.domain.hooks.effect(n),n}let Rt=typeof Symbol<"u"&&Symbol.observable||"@@observable",ne="map",ae="stack",T=e=>e.graphite||e,he=e=>e.family.owners,Se=e=>e.family.links,ve=e=>e.stateRef,ee=e=>e.value,me=e=>e.subscribers,N=e=>e.parent,P=e=>e.scope,L=(e,t)=>T(e).meta[t],te=(e,t,r)=>T(e).meta[t]=r,Lt=e=>e.compositeName,Be=e=>(M(e)||j(e))&&"kind"in e;const ue=e=>t=>Be(t)&&t.kind===e;let $e=ue("store"),kt=ue("event"),Ue=ue("effect"),it=ue("domain"),xt=ue("scope");var Vt={__proto__:null,unit:Be,store:$e,event:kt,effect:Ue,domain:it,scope:xt,attached:e=>Ue(e)&&L(e,"attached")==1};let fe=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},C=(e,t)=>e.push(t),oe=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const ge=()=>{let e=0;return()=>""+ ++e};let Mt=ge(),st=ge(),Ct=ge(),Dt=ge(),H=null,ut=()=>H,Tt=e=>(e&&H&&H.sidRoot&&(e=`${H.sidRoot}|${e}`),e),Ne=(e,t)=>{let r=T(e);V(t,n=>{let o=T(n);r.family.type!=="domain"&&(o.family.type="crosslink"),C(he(o),r),C(Se(r),o)})},le=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(T),j=e=>typeof e=="object"&&e!==null,M=e=>typeof e=="function",q=e=>e===void 0,Pt=e=>I(j(e)||M(e),"expect first argument be an object");const Ye=(e,t,r,n)=>I(!(!j(e)&&!M(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${n}`);let It=(e,t,r)=>{Array.isArray(e)?V(e,(n,o)=>Ye(n,t,`${o} item of ${r}`,"")):Ye(e,t,r," or array of units")},Je=(e,{fn:t},{a:r})=>t(e,r),Bt=(e,{fn:t},{a:r})=>t(r,e),je=(e,{fn:t})=>t(e);const lt=(e,t,r,n)=>{let o={id:st(),type:e,data:t};return r&&(o.order={priority:r},n&&(o.order.barrierID=++$t)),o};let $t=0,_e=({from:e="store",store:t,target:r,to:n=r?"store":ae,batch:o,priority:l})=>lt("mov",{from:e,store:t,to:n,target:r},l,o),ie=({fn:e,batch:t,priority:r,safe:n=0,filter:o=0,pure:l=0})=>lt("compute",{fn:e,safe:n,filter:o,pure:l},r,t),ze=({fn:e})=>ie({fn:e,priority:"effect"}),F=(e,t,r)=>ie({fn:e,safe:1,filter:t,priority:r&&"effect"}),Nt=(e,t,r)=>_e({store:e,to:t?ae:"a",priority:r&&"sampler",batch:1}),W=(e=je,t)=>ie({fn:e,pure:1,filter:t}),jt={mov:_e,compute:ie,filter:({fn:e,pure:t})=>ie({fn:e,filter:1,pure:t}),run:ze},zt=e=>({id:st(),current:e}),ct=({current:e})=>e,qt=(e,t)=>{e.before||(e.before=[]),C(e.before,t)},G=null;const qe=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Ce(e.v.type)>Ce(t.v.type))&&(r=e,e=t,t=r),r=qe(e.r,t),e.r=e.l,e.l=r,e},We=[];let Qe=0;for(;Qe<6;)C(We,{first:null,last:null,size:0}),Qe+=1;const Wt=()=>{for(let e=0;e<6;e++){let t=We[e];if(t.size>0){if(e===3||e===4){t.size-=1;let n=G.v;return G=qe(G.l,G.r),n}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},$=(e,t,r,n,o,l,a)=>Me(0,{a:null,b:null,node:r,parent:n,value:o,page:t,scope:l,meta:a},e),Me=(e,t,r,n=0)=>{let o=Ce(r),l=We[o],a={v:{idx:e,stack:t,type:r,id:n},l:null,r:null};o===3||o===4?G=qe(G,a):(l.size===0?l.first=a:l.last.r=a,l.last=a),l.size+=1},Ce=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},Ae=new Set;let O,ce=1,de=0,pe=0,D=null,Gt=e=>{O=e},Xe=e=>{D=e};const ft=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=N(e);if(e)return e}return null};let Ht=(e,t,r,n,o)=>{let l=ft(e,n.id);return l?l.reg[n.id]:t?(K(t,n,o),t.reg[n.id]):n};const Ft=e=>e;let K=(e,t,r,n,o)=>{var l;let a=e.reg,v=t.sid,_=t==null||(l=t.meta)===null||l===void 0?void 0:l.serialize;if(a[t.id])return;let f={id:t.id,current:t.current,meta:t.meta};if(v&&v in e.sidValuesMap&&!(v in e.sidIdMap))f.current=(e.fromSerialize&&_!=="ignore"&&(_==null?void 0:_.read)||Ft)(e.sidValuesMap[v]);else if(t.before&&!o){let h=0,c=r||!t.noInit||n;V(t.before,p=>{switch(p.type){case ne:{let i=p.from;if(i||p.fn){i&&K(e,i,r,n);let s=i&&a[i.id].current;c&&(f.current=p.fn?p.fn(s):s)}break}case"field":h||(h=1,f.current=Array.isArray(f.current)?[...f.current]:{...f.current}),K(e,p.from,r,n),c&&(f.current[p.field]=a[a[p.from.id].id].current)}})}v&&(e.sidIdMap[v]=t.id),a[t.id]=f};const Kt=(e,t,r)=>{try{return t(ee(r),e.scope,r)}catch(n){console.error(n),e.fail=1}};let U=(e,t={})=>(j(e)&&(U(e.or,t),Ot(e,(r,n)=>{q(r)||n==="or"||n==="and"||(t[n]=r)}),U(e.and,t)),t);const Ze=(e,t)=>{fe(e.next,t),fe(he(e),t),fe(Se(e),t)},De=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let o=Se(e);for(;n=o.pop();)Ze(n,e),(t||r&&L(e,"op")!=="sample"||n.family.type==="crosslink")&&De(n,t,L(n,"op")!=="on"&&r);for(o=he(e);n=o.pop();)Ze(n,e),r&&n.family.type==="crosslink"&&De(n,t,L(n,"op")!=="on"&&r)},X=e=>e.clear();let Te=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),$e(e))X(me(e));else if(it(e)){r=1;let n=e.history;X(n.events),X(n.effects),X(n.stores),X(n.domains)}De(T(e),!!t,r)},dt=e=>{let t=()=>Te(e);return t.unsubscribe=t,t},Ge=(e,t,r,n,o)=>B({node:r,parent:e,child:t,scope:{fn:o},meta:{op:n},family:{owners:[e,t],links:t},regional:1}),pt=(e,t)=>(I(M(t),".watch argument should be a function"),dt(B({scope:{fn:t},node:[ze({fn:je})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),Ut=(e,t,r="event")=>{N(e)&&N(e).hooks[r](t)},vt=(e,t,r)=>{let n=U(r),o=e==="domain",l=Mt(),{sid:a=null,named:v=null,domain:_=null,parent:f=_}=n,h=v||n.name||(o?"":l),c=bt(h,f),p={op:t.kind=e,name:t.shortName=h,sid:t.sid=Tt(a),named:v,unitId:t.id=l,serialize:n.serialize,derived:n.derived,config:n};return t.parent=f,t.compositeName=c,t.defaultConfig=n,t.thru=i=>(oe(0,"thru","js pipe"),i(t)),t.getType=()=>c.fullName,!o&&(t.subscribe=i=>(Pt(i),t.watch(M(i)?i:s=>i.next&&i.next(s))),t[Rt]=()=>t),p};const Re=(e,t,r,n)=>{let o;j(r)&&(o=r,r=r.fn);let l=x({name:`${e.shortName} → *`,derived:1,and:o});return Ge(e,l,n,t,r),l},mt=(e,t,r,n,o)=>{let l=ve(t),a=_e({store:l,to:"a",priority:"read"});r===ne&&(a.data.softRead=1);let v=[a,W(n)];return Z("storeOnMap",l,v,$e(e)&&ve(e)),Ge(e,t,v,r,o)};let Yt=(e,t,r)=>{try{return[1,e(...r)]}catch(n){return t(n),[0,null]}},Jt=e=>{let t=P(e),r={ref:t};return t&&C(t.activeEffects,r),r},et=(e,t,r,n,o,l)=>a=>{l.ref&&fe(l.ref.activeEffects,l),re({target:[n,Qt],params:[r?{status:"done",params:e,result:a}:{status:"fail",params:e,error:a},{value:a,fn:r?t.rs:t.rj}],defer:1,page:o.page,scope:l.ref,meta:o.meta})};const Qt=B({node:[ze({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}}),Xt={subscribers:[],changeState(e){window.history.pushState(e,""),this.fireChangeStateEvent()},fireChangeStateEvent(){this._trigerEvent("changestate",window.history.state)},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r})},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}},Zt=Y(()=>{window.isBackFromBrowser=!1,window.history.back()}),z=Y(e=>{const{view:t,panel:r,modal:n,popout:o}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};Xt.changeState({view:e.hasOwnProperty("view")?e.view:t,panel:e.hasOwnProperty("panel")?e.panel:r,modal:e.hasOwnProperty("modal")?e.modal:n,popout:e.hasOwnProperty("popout")?e.popout:o})}),er=Y(e=>{z({view:e.view,panel:e.panel})}),tr=Y(e=>{z({panel:e})}),rr=Y(e=>{z({modal:e})}),nr=Y(e=>{z({popout:e})}),ht=x(),St=x(),gt=x(),He=x(),Fe=x(),_t=x(),ar=x(),or=Ie({activeView:null,activePanel:null,activeModal:null,activePopout:null,isRouteInit:!1,isBackHandled:!0}).on(ht,(e,t)=>({...e,activeView:t})).on(St,(e,t)=>({...e,activePanel:t})).on(He,(e,t)=>({...e,activeModal:t})).on(Fe,(e,t)=>({...e,activePopout:t})).on(_t,e=>({...e,isRouteInit:!0})).on(gt,(e,{view:t,panel:r})=>({...e,activeView:t,activePanel:r})).on(ar,(e,t)=>({...e,isBackHandled:t}));function ir(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tt={},sr={get exports(){return tt},set exports(e){tt=e}},Le={},se={},ur={get exports(){return se},set exports(e){se=e}},ke={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rt;function lr(){if(rt)return ke;rt=1;var e=k;function t(c,p){return c===p&&(c!==0||1/c===1/p)||c!==c&&p!==p}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,o=e.useEffect,l=e.useLayoutEffect,a=e.useDebugValue;function v(c,p){var i=p(),s=n({inst:{value:i,getSnapshot:p}}),u=s[0].inst,d=s[1];return l(function(){u.value=i,u.getSnapshot=p,_(u)&&d({inst:u})},[c,i,p]),o(function(){return _(u)&&d({inst:u}),c(function(){_(u)&&d({inst:u})})},[c]),a(i),i}function _(c){var p=c.getSnapshot;c=c.value;try{var i=p();return!r(c,i)}catch{return!0}}function f(c,p){return p()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:v;return ke.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,ke}var xe={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nt;function cr(){return nt||(nt=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=k,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(w){{for(var m=arguments.length,y=new Array(m>1?m-1:0),S=1;S<m;S++)y[S-1]=arguments[S];n("error",w,y)}}function n(w,m,y){{var S=t.ReactDebugCurrentFrame,g=S.getStackAddendum();g!==""&&(m+="%s",y=y.concat([g]));var E=y.map(function(R){return String(R)});E.unshift("Warning: "+m),Function.prototype.apply.call(console[w],console,E)}}function o(w,m){return w===m&&(w!==0||1/w===1/m)||w!==w&&m!==m}var l=typeof Object.is=="function"?Object.is:o,a=e.useState,v=e.useEffect,_=e.useLayoutEffect,f=e.useDebugValue,h=!1,c=!1;function p(w,m,y){h||e.startTransition!==void 0&&(h=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var S=m();if(!c){var g=m();l(S,g)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),c=!0)}var E=a({inst:{value:S,getSnapshot:m}}),R=E[0].inst,J=E[1];return _(function(){R.value=S,R.getSnapshot=m,i(R)&&J({inst:R})},[w,S,m]),v(function(){i(R)&&J({inst:R});var ye=function(){i(R)&&J({inst:R})};return w(ye)},[w]),f(S),S}function i(w){var m=w.getSnapshot,y=w.value;try{var S=m();return!l(y,S)}catch{return!0}}function s(w,m,y){return m()}var u=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",d=!u,b=d?s:p,A=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:b;xe.useSyncExternalStore=A,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),xe}(function(e){process.env.NODE_ENV==="production"?e.exports=lr():e.exports=cr()})(ur);const fr=ir(se);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var at;function dr(){if(at)return Le;at=1;var e=k,t=se;function r(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,l=e.useRef,a=e.useEffect,v=e.useMemo,_=e.useDebugValue;return Le.useSyncExternalStoreWithSelector=function(f,h,c,p,i){var s=l(null);if(s.current===null){var u={hasValue:!1,value:null};s.current=u}else u=s.current;s=v(function(){function b(S){if(!A){if(A=!0,w=S,S=p(S),i!==void 0&&u.hasValue){var g=u.value;if(i(g,S))return m=g}return m=S}if(g=m,n(w,S))return g;var E=p(S);return i!==void 0&&i(g,E)?g:(w=S,m=E)}var A=!1,w,m,y=c===void 0?null:c;return[function(){return b(h())},y===null?void 0:function(){return b(y())}]},[h,c,p,i]);var d=o(f,s[0],s[1]);return a(function(){u.hasValue=!0,u.value=d},[d]),_(d),d},Le}var Ve={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ot;function pr(){return ot||(ot=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=k,t=se;function r(h,c){return h===c&&(h!==0||1/h===1/c)||h!==h&&c!==c}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,l=e.useRef,a=e.useEffect,v=e.useMemo,_=e.useDebugValue;function f(h,c,p,i,s){var u=l(null),d;u.current===null?(d={hasValue:!1,value:null},u.current=d):d=u.current;var b=v(function(){var y=!1,S,g,E=function(Q){if(!y){y=!0,S=Q;var we=i(Q);if(s!==void 0&&d.hasValue){var Ee=d.value;if(s(Ee,we))return g=Ee,Ee}return g=we,we}var Et=S,Oe=g;if(n(Et,Q))return Oe;var be=i(Q);return s!==void 0&&s(Oe,be)?Oe:(S=Q,g=be,be)},R=p===void 0?null:p,J=function(){return E(c())},ye=R===null?void 0:function(){return E(R())};return[J,ye]},[c,p,i,s]),A=b[0],w=b[1],m=o(h,A,w);return a(function(){d.hasValue=!0,d.value=m},[m]),_(m),m}Ve.useSyncExternalStoreWithSelector=f,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Ve}(function(e){process.env.NODE_ENV==="production"?e.exports=dr():e.exports=pr()})(sr);function vr(e,t,r,n){let o=[jt.run({fn:l=>t(l)})];if(n&&o.unshift(n),r){let l=B({node:o}),a=e.graphite.id,v=r.additionalLinks,_=v[a]||[];return v[a]=_,_.push(l),()=>{let f=_.indexOf(l);f!==-1&&_.splice(f,1),Te(l)}}{let l=B({node:o,parent:[e],family:{owners:e}});return()=>{Te(l)}}}function mr(e,t){Vt.store(e)||yt("expect useStore argument to be a store");let r=k.useCallback(o=>vr(e,o,t),[e,t]),n=k.useCallback(()=>_r(e,t),[e,t]);return gr(r,n,n)}function hr(e){let t=k.useContext(yr);return e&&!t&&yt("No scope found, consider adding <Provider> to app root"),t}function Sr(e,t){return mr(e,hr(t==null?void 0:t.forceScope))}let yt=e=>{throw Error(e)};typeof window<"u"?k.useLayoutEffect:k.useEffect;const{useSyncExternalStore:gr}=fr,_r=(e,t)=>t?t.getState(e):e.getState(),yr=k.createContext(null),Pe={subscribers:[],changeState(e){window.history.pushState(e,""),this.fireChangeStateEvent()},fireChangeStateEvent(){this._trigerEvent("changestate",window.history.state)},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r})},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}},wr=(e,t,r)=>{k.useEffect(()=>{const n=o=>{o instanceof KeyboardEvent&&o.key===r?t(o):r||t(o)};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)},[e,r,t])},Er=(e,t,r)=>{k.useEffect(()=>(Pe.addEventListener(e,t,r),()=>Pe.removeEventListener(r)),[e,r,t])},Or=(e,...t)=>{const{activeView:r,activePanel:n,activeModal:o,activePopout:l,isRouteInit:a}=wt();k.useEffect(()=>{a||(z(e),_t())},[a,e]),wr("popstate",async()=>{a&&(await(async()=>{Pe.fireChangeStateEvent();const{view:_,panel:f,modal:h,popout:c}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};console.log("prevRoutes",_,f,h,c),console.log("storeRoutes",r,n,o,l);for(const p in t)if(!await t[p]({view:r,panel:n,modal:o,popout:l},{view:_,panel:f,modal:h,popout:c}))return})(),window.isBackFromBrowser=!0)}),Er("changestate",v=>{if(console.log("[blum]: state changed",v),v){const{view:_,panel:f,modal:h,popout:c}=v;_&&f&&gt({view:_,panel:f}),He(h),Fe(c)}},1)},wt=()=>Sr(or),br=e=>e,Ar=(e,t)=>(r,n)=>["view","panel","modal","popout"].some(l=>r[l]===e&&r[l]!==n[l])&&window.isBackFromBrowser?(t&&t(r,n),z(r),!1):!0;exports._setActiveModal=He;exports._setActivePanel=St;exports._setActivePopout=Fe;exports._setActiveView=ht;exports.back=Zt;exports.createDisableBackBrowserRouteMiddleware=Ar;exports.createRouteMiddleware=br;exports.historyPush=z;exports.setActiveModal=rr;exports.setActivePanel=tr;exports.setActivePopout=nr;exports.setActiveViewPanel=er;exports.useInitRouter=Or;exports.useRouter=wt;
