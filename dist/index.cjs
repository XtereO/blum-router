"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const R=require("react"),O={isDispatchChangeStateEventBeforeMiddleware:!1,isDispatchChangeStateEventAfterMiddleware:!0,beforeBackHandledCallback:null,isBackFromBrowser:!0,afterBackHandledCallback:null,subscribers:[],setDefaultBackHandlerOptions(){this.setBackHandlerOptions({isDispatchChangeStateEventAfterMiddleware:!0,isDispatchChangeStateEventBeforeMiddleware:!1,beforeBackHandledCallback:null,afterBackHandledCallback:null,isBackFromBrowser:!0})},setBackHandlerOptions(e){Object.keys(e).forEach(t=>{e.hasOwnProperty(t)&&(O[t]=e[t])}),e.hasOwnProperty("beforeBackHandledCallback")&&(O.beforeBackHandledCallback=e.beforeBackHandledCallback),e.hasOwnProperty("afterBackHandledCallback")&&(O.afterBackHandledCallback=e.afterBackHandledCallback),e.hasOwnProperty("isDispatchChangeStateEventAfterMiddleware")&&(O.isDispatchChangeStateEventAfterMiddleware=e.isDispatchChangeStateEventAfterMiddleware),e.hasOwnProperty("isDispatchChangeStateEventBeforeMiddleware")&&(O.isDispatchChangeStateEventBeforeMiddleware=e.isDispatchChangeStateEventBeforeMiddleware),e.hasOwnProperty("isBackFromBrowser")&&(O.isBackFromBrowser=e.isBackFromBrowser)},historyPush(e){const{view:t,panel:r,modal:n,popout:o}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};console.log("try to push history",this),this.changeState({view:e.hasOwnProperty("view")?e.view:t,panel:e.hasOwnProperty("panel")?e.panel:r,modal:e.hasOwnProperty("modal")?e.modal:n,popout:e.hasOwnProperty("popout")?e.popout:o})},changeState(e){try{window.history.pushState(e,""),this.dispatchChangeStateEvent()}catch(t){console.log("changeState err",t)}},dispatchChangeStateEvent(){this._trigerEvent("changestate",window.history.state)},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r}),e==="changestate"&&this._trigerEvent("init",!0)},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}},Et=e=>{e&&O.setBackHandlerOptions(e),(!e||!e.hasOwnProperty("isBackFromBrowser"))&&O.setBackHandlerOptions({isBackFromBrowser:!1}),window.history.back()},Ot=e=>{O.historyPush({view:e.view,panel:e.panel})},bt=e=>{O.historyPush({panel:e})},kt=e=>{O.historyPush({modal:e})},Bt=e=>{O.historyPush({popout:e})};function At(e,t){for(let r in e)t(e[r],r)}function L(e,t){e.forEach(t)}function j(e,t){if(!e)throw Error(t)}function H({node:e=[],from:t,source:r,parent:n=t||r,to:o,target:i,child:a=o||i,scope:p={},meta:g={},family:c={type:"regular"},regional:S}={}){let u=oe(n),d=oe(c.links),f=oe(c.owners),s=[];L(e,v=>v&&V(s,v));let l={id:xt(),seq:s,next:oe(a),meta:g,scope:p,family:{type:c.type||"crosslink",links:d,owners:f}};return L(d,v=>V(ce(v),l)),L(f,v=>V(fe(v),l)),L(u,v=>V(v.next,l)),S&&z&&it(J(z),[l]),l}function tt(e,t,r){let n,o=D,i=null,a=b;if(e.target&&(t=e.params,r=e.defer,n=e.meta,o="page"in e?e.page:o,e.stack&&(i=e.stack),a=ae(e)||a,e=e.target),a&&b&&a!==b&&(b=null),Array.isArray(e))for(let s=0;s<e.length;s++)x("pure",o,P(e[s]),i,t[s],a,n);else x("pure",o,P(e),i,t,a,n);if(r&&!ie)return;let p,g,c,S,u,d,f={isRoot:ie,currentPage:D,scope:b,isWatch:ye,isPure:se};ie=0;e:for(;S=Ft();){let{idx:s,stack:l,type:v}=S;c=l.node,D=u=l.page,b=ae(l),u?d=u.reg:b&&(d=b.reg);let B=!!u,C=!!b,_={fail:0,scope:c.scope};p=g=0;for(let h=s;h<c.seq.length&&!p;h++){let y=c.seq[h];if(y.order){let{priority:m,barrierID:w}=y.order,E=w?u?`${u.fullID}_${w}`:w:0;if(h!==s||v!==m){w?we.has(E)||(we.add(E),Ae(h,l,m,w)):Ae(h,l,m);continue e}w&&we.delete(E)}switch(y.type){case"mov":{let w,E=y.data;switch(E.from){case X:w=J(l);break;case"a":case"b":w=l[E.from];break;case"value":w=E.store;break;case"store":if(d&&!d[E.store.id])if(B){let k=ut(u,E.store.id);l.page=u=k,k?d=k.reg:C?(G(b,E.store,0,1,E.softRead),d=b.reg):d=void 0}else C&&G(b,E.store,0,1,E.softRead);w=lt(d&&d[E.store.id]||E.store)}switch(E.to){case X:l.value=w;break;case"a":case"b":l[E.to]=w;break;case"store":Kt(u,b,c,E.target).current=w}break}case"compute":let m=y.data;if(m.fn){ye=A(c,"op")==="watch",se=m.pure;let w=m.safe?(0,m.fn)(J(l),_.scope,l):qt(_,m.fn,l);m.filter?g=!w:l.value=w,ye=f.isWatch,se=f.isPure}}p=_.fail||g}if(!p){let h=J(l),y=ae(l);if(L(c.next,m=>{x("child",u,m,l,h,y)}),y){A(c,"needFxCounter")&&x("child",u,y.fxCount,l,h,y),A(c,"storeChange")&&x("child",u,y.storeChange,l,h,y),A(c,"warnSerialize")&&x("child",u,y.warnSerializeNode,l,h,y);let m=y.additionalLinks[c.id];m&&L(m,w=>{x("child",u,w,l,h,y)})}}}ie=f.isRoot,D=f.currentPage,b=ae(f)}function Ct(e,t){let r,n,o=e;if(t){let i=Lt(t);e.length===0?(r=i.path,n=i.fullName):(r=i.path.concat([e]),n=i.fullName.length===0?e:i.fullName+"/"+e)}else r=e.length===0?[]:[e],n=e;return{shortName:o,fullName:n,path:r}}function Y(e,...t){let r=ot();if(r){let n=r.handlers[e];if(n)return n(r,...t)}}function M(e,t){let r=te({or:t,and:typeof e=="string"?{name:e}:e}),n=(a,...p)=>(Z(!A(n,"derived"),"call of derived event","createEvent"),Z(!se,"unit call from pure function","operators like sample"),D?((g,c,S,u)=>{let d=D,f=null;if(c)for(f=D;f&&f.template!==c;)f=W(f);Ue(f);let s=g.create(S,u);return Ue(d),s})(n,o,a,p):n.create(a,p)),o=ot(),i=Object.assign(n,{graphite:H({meta:dt("event",n,r),regional:1}),create:a=>(tt({target:n,params:a,scope:b}),a),watch:a=>ft(n,a),map:a=>_e(n,Q,a,[N()]),filter:a=>_e(n,"filter",a.fn?a:a.fn,[N(Ve,1)]),filterMap:a=>_e(n,"filterMap",a,[N(),Be(p=>!I(p),1)]),prepend(a){let p=M("* → "+n.shortName,{parent:W(n)});return Y("eventPrepend",P(p)),Ie(p,n,[N()],"prepend",a),Yt(n,p),p}});return r!=null&&r.domain&&r.domain.hooks.event(i),i}function ze(e,t,r,n){return It(r,t,"first argument"),j(T(n),"second argument should be a function"),Z(!A(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),L(Array.isArray(r)?r:[r],o=>{e.off(o),ue(e).set(o,ct(pt(o,e,"on",Nt,n)))}),e}function rt(e,t){let r=te(t),n=Wt(e),o=M({named:"updates",derived:1});Y("storeBase",n);let i=n.id,a={subscribers:new Map,updates:o,defaultState:e,stateRef:n,getState(){let s,l=n;if(D){let v=D;for(;v&&!v.reg[i];)v=W(v);v&&(s=v)}return!s&&b&&(G(b,n,1),s=b),s&&(l=s.reg[i]),lt(l)},setState:s=>tt({target:a,params:s,defer:1,scope:b}),reset:(...s)=>(L(s,l=>ze(a,".reset",l,()=>a.defaultState)),a),on:(s,l)=>ze(a,".on",s,l),off(s){let l=ue(a).get(s);return l&&(l(),ue(a).delete(s)),a},map(s,l){let v,B;F(s)&&(v=s,s=s.fn),Z(I(l),"second argument of store.map","updateFilter");let C=a.getState();I(C)||(B=s(C,l));let _=rt(B,{name:`${a.shortName} → *`,derived:1,and:v}),h=pt(a,_,Q,Fe,s);return Gt(le(_),{type:Q,fn:s,from:n}),le(_).noInit=1,Y("storeMap",n,h),_},watch(s,l){if(!l||!Me(s)){let v=ft(a,s);return Y("storeWatch",n,s)||s(a.getState()),v}return j(T(l),"second argument should be a function"),s.watch(v=>l(a.getState(),v))}},p=dt("store",a,r),g=a.defaultConfig.updateFilter;a.graphite=H({scope:{state:n,fn:g},node:[Be((s,l,v)=>(v.scope&&!v.scope.reg[n.id]&&(v.b=1),s)),zt(n),Be((s,l,{a:v,b:B})=>!I(s)&&(s!==v||B),1),g&&N(Fe,1),de({from:X,target:n})],child:o,meta:p,regional:1});let c=A(a,"serialize"),S=A(a,"derived"),u=c==="ignore",d=!c||u?0:c,f=A(a,"sid");return f&&(u||je(a,"storeChange",1),n.sid=f,d&&(n.meta={...n==null?void 0:n.meta,serialize:d})),f||u||S||je(a,"warnSerialize",1),j(S||!I(e),"current state can't be undefined, use null instead"),it(a,[o]),r!=null&&r.domain&&r.domain.hooks.store(a),S||(a.reinit=M(),a.reset(a.reinit)),a}let Rt=typeof Symbol<"u"&&Symbol.observable||"@@observable",Q="map",X="stack",P=e=>e.graphite||e,ce=e=>e.family.owners,fe=e=>e.family.links,le=e=>e.stateRef,J=e=>e.value,ue=e=>e.subscribers,W=e=>e.parent,ae=e=>e.scope,A=(e,t)=>P(e).meta[t],je=(e,t,r)=>P(e).meta[t]=r,Lt=e=>e.compositeName,Me=e=>(T(e)||F(e))&&"kind"in e;const ne=e=>t=>Me(t)&&t.kind===e;let De=ne("store"),Mt=ne("event"),We=ne("effect"),nt=ne("domain"),Dt=ne("scope");var Pt={__proto__:null,unit:Me,store:De,event:Mt,effect:We,domain:nt,scope:Dt,attached:e=>We(e)&&A(e,"attached")==1};let ge=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},V=(e,t)=>e.push(t),Z=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const Pe=()=>{let e=0;return()=>""+ ++e};let Vt=Pe(),at=Pe(),xt=Pe(),z=null,ot=()=>z,Ht=e=>(e&&z&&z.sidRoot&&(e=`${z.sidRoot}|${e}`),e),it=(e,t)=>{let r=P(e);L(t,n=>{let o=P(n);r.family.type!=="domain"&&(o.family.type="crosslink"),V(ce(o),r),V(fe(r),o)})},oe=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(P),F=e=>typeof e=="object"&&e!==null,T=e=>typeof e=="function",I=e=>e===void 0,Tt=e=>j(F(e)||T(e),"expect first argument be an object");const Ge=(e,t,r,n)=>j(!(!F(e)&&!T(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${n}`);let It=(e,t,r)=>{Array.isArray(e)?L(e,(n,o)=>Ge(n,t,`${o} item of ${r}`,"")):Ge(e,t,r," or array of units")},Fe=(e,{fn:t},{a:r})=>t(e,r),Nt=(e,{fn:t},{a:r})=>t(r,e),Ve=(e,{fn:t})=>t(e);const st=(e,t,r,n)=>{let o={id:at(),type:e,data:t};return r&&(o.order={priority:r},n&&(o.order.barrierID=++$t)),o};let $t=0,de=({from:e="store",store:t,target:r,to:n=r?"store":X,batch:o,priority:i})=>st("mov",{from:e,store:t,to:n,target:r},i,o),ee=({fn:e,batch:t,priority:r,safe:n=0,filter:o=0,pure:i=0})=>st("compute",{fn:e,safe:n,filter:o,pure:i},r,t),xe=({fn:e})=>ee({fn:e,priority:"effect"}),Be=(e,t,r)=>ee({fn:e,safe:1,filter:t,priority:r&&"effect"}),zt=(e,t,r)=>de({store:e,to:t?X:"a",priority:r&&"sampler",batch:1}),N=(e=Ve,t)=>ee({fn:e,pure:1,filter:t}),jt={mov:de,compute:ee,filter:({fn:e,pure:t})=>ee({fn:e,filter:1,pure:t}),run:xe},Wt=e=>({id:at(),current:e}),lt=({current:e})=>e,Gt=(e,t)=>{e.before||(e.before=[]),V(e.before,t)},$=null;const He=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Ce(e.v.type)>Ce(t.v.type))&&(r=e,e=t,t=r),r=He(e.r,t),e.r=e.l,e.l=r,e},Te=[];let Ke=0;for(;Ke<6;)V(Te,{first:null,last:null,size:0}),Ke+=1;const Ft=()=>{for(let e=0;e<6;e++){let t=Te[e];if(t.size>0){if(e===3||e===4){t.size-=1;let n=$.v;return $=He($.l,$.r),n}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},x=(e,t,r,n,o,i,a)=>Ae(0,{a:null,b:null,node:r,parent:n,value:o,page:t,scope:i,meta:a},e),Ae=(e,t,r,n=0)=>{let o=Ce(r),i=Te[o],a={v:{idx:e,stack:t,type:r,id:n},l:null,r:null};o===3||o===4?$=He($,a):(i.size===0?i.first=a:i.last.r=a,i.last=a),i.size+=1},Ce=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},we=new Set;let b,ie=1,ye=0,se=0,D=null,Ue=e=>{D=e};const ut=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=W(e);if(e)return e}return null};let Kt=(e,t,r,n,o)=>{let i=ut(e,n.id);return i?i.reg[n.id]:t?(G(t,n,o),t.reg[n.id]):n};const Ut=e=>e;let G=(e,t,r,n,o)=>{var i;let a=e.reg,p=t.sid,g=t==null||(i=t.meta)===null||i===void 0?void 0:i.serialize;if(a[t.id])return;let c={id:t.id,current:t.current,meta:t.meta};if(p&&p in e.sidValuesMap&&!(p in e.sidIdMap))c.current=(e.fromSerialize&&g!=="ignore"&&(g==null?void 0:g.read)||Ut)(e.sidValuesMap[p]);else if(t.before&&!o){let S=0,u=r||!t.noInit||n;L(t.before,d=>{switch(d.type){case Q:{let f=d.from;if(f||d.fn){f&&G(e,f,r,n);let s=f&&a[f.id].current;u&&(c.current=d.fn?d.fn(s):s)}break}case"field":S||(S=1,c.current=Array.isArray(c.current)?[...c.current]:{...c.current}),G(e,d.from,r,n),u&&(c.current[d.field]=a[a[d.from.id].id].current)}})}p&&(e.sidIdMap[p]=t.id),a[t.id]=c};const qt=(e,t,r)=>{try{return t(J(r),e.scope,r)}catch(n){console.error(n),e.fail=1}};let te=(e,t={})=>(F(e)&&(te(e.or,t),At(e,(r,n)=>{I(r)||n==="or"||n==="and"||(t[n]=r)}),te(e.and,t)),t);const qe=(e,t)=>{ge(e.next,t),ge(ce(e),t),ge(fe(e),t)},Re=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let o=fe(e);for(;n=o.pop();)qe(n,e),(t||r&&A(e,"op")!=="sample"||n.family.type==="crosslink")&&Re(n,t,A(n,"op")!=="on"&&r);for(o=ce(e);n=o.pop();)qe(n,e),r&&n.family.type==="crosslink"&&Re(n,t,A(n,"op")!=="on"&&r)},q=e=>e.clear();let Le=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),De(e))q(ue(e));else if(nt(e)){r=1;let n=e.history;q(n.events),q(n.effects),q(n.stores),q(n.domains)}Re(P(e),!!t,r)},ct=e=>{let t=()=>Le(e);return t.unsubscribe=t,t},Ie=(e,t,r,n,o)=>H({node:r,parent:e,child:t,scope:{fn:o},meta:{op:n},family:{owners:[e,t],links:t},regional:1}),ft=(e,t)=>(j(T(t),".watch argument should be a function"),ct(H({scope:{fn:t},node:[xe({fn:Ve})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),Yt=(e,t,r="event")=>{W(e)&&W(e).hooks[r](t)},dt=(e,t,r)=>{let n=te(r),o=e==="domain",i=Vt(),{sid:a=null,named:p=null,domain:g=null,parent:c=g}=n,S=p||n.name||(o?"":i),u=Ct(S,c),d={op:t.kind=e,name:t.shortName=S,sid:t.sid=Ht(a),named:p,unitId:t.id=i,serialize:n.serialize,derived:n.derived,config:n};return t.parent=c,t.compositeName=u,t.defaultConfig=n,t.thru=f=>(Z(0,"thru","js pipe"),f(t)),t.getType=()=>u.fullName,!o&&(t.subscribe=f=>(Tt(f),t.watch(T(f)?f:s=>f.next&&f.next(s))),t[Rt]=()=>t),d};const _e=(e,t,r,n)=>{let o;F(r)&&(o=r,r=r.fn);let i=M({name:`${e.shortName} → *`,derived:1,and:o});return Ie(e,i,n,t,r),i},pt=(e,t,r,n,o)=>{let i=le(t),a=de({store:i,to:"a",priority:"read"});r===Q&&(a.data.softRead=1);let p=[a,N(n)];return Y("storeOnMap",i,p,De(e)&&le(e)),Ie(e,t,p,r,o)};H({node:[xe({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}});const vt=M(),ht=M(),mt=M(),Ne=M(),$e=M(),St=M(),Jt=M(),Qt=rt({activeView:null,activePanel:null,activeModal:null,activePopout:null,isRouteInit:!1,isBackHandled:!0}).on(vt,(e,t)=>({...e,activeView:t})).on(ht,(e,t)=>({...e,activePanel:t})).on(Ne,(e,t)=>({...e,activeModal:t})).on($e,(e,t)=>({...e,activePopout:t})).on(St,e=>({...e,isRouteInit:!0})).on(mt,(e,{view:t,panel:r})=>({...e,activeView:t,activePanel:r})).on(Jt,(e,t)=>({...e,isBackHandled:t}));function Xt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ye={},Zt={get exports(){return Ye},set exports(e){Ye=e}},Ee={},re={},er={get exports(){return re},set exports(e){re=e}},Oe={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Je;function tr(){if(Je)return Oe;Je=1;var e=R;function t(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,o=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function p(u,d){var f=d(),s=n({inst:{value:f,getSnapshot:d}}),l=s[0].inst,v=s[1];return i(function(){l.value=f,l.getSnapshot=d,g(l)&&v({inst:l})},[u,f,d]),o(function(){return g(l)&&v({inst:l}),u(function(){g(l)&&v({inst:l})})},[u]),a(f),f}function g(u){var d=u.getSnapshot;u=u.value;try{var f=d();return!r(u,f)}catch{return!0}}function c(u,d){return d()}var S=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:p;return Oe.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:S,Oe}var be={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qe;function rr(){return Qe||(Qe=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=R,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(_){{for(var h=arguments.length,y=new Array(h>1?h-1:0),m=1;m<h;m++)y[m-1]=arguments[m];n("error",_,y)}}function n(_,h,y){{var m=t.ReactDebugCurrentFrame,w=m.getStackAddendum();w!==""&&(h+="%s",y=y.concat([w]));var E=y.map(function(k){return String(k)});E.unshift("Warning: "+h),Function.prototype.apply.call(console[_],console,E)}}function o(_,h){return _===h&&(_!==0||1/_===1/h)||_!==_&&h!==h}var i=typeof Object.is=="function"?Object.is:o,a=e.useState,p=e.useEffect,g=e.useLayoutEffect,c=e.useDebugValue,S=!1,u=!1;function d(_,h,y){S||e.startTransition!==void 0&&(S=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var m=h();if(!u){var w=h();i(m,w)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),u=!0)}var E=a({inst:{value:m,getSnapshot:h}}),k=E[0].inst,K=E[1];return g(function(){k.value=m,k.getSnapshot=h,f(k)&&K({inst:k})},[_,m,h]),p(function(){f(k)&&K({inst:k});var pe=function(){f(k)&&K({inst:k})};return _(pe)},[_]),c(m),m}function f(_){var h=_.getSnapshot,y=_.value;try{var m=h();return!i(y,m)}catch{return!0}}function s(_,h,y){return h()}var l=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",v=!l,B=v?s:d,C=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:B;be.useSyncExternalStore=C,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),be}(function(e){process.env.NODE_ENV==="production"?e.exports=tr():e.exports=rr()})(er);const nr=Xt(re);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe;function ar(){if(Xe)return Ee;Xe=1;var e=R,t=re;function r(c,S){return c===S&&(c!==0||1/c===1/S)||c!==c&&S!==S}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,p=e.useMemo,g=e.useDebugValue;return Ee.useSyncExternalStoreWithSelector=function(c,S,u,d,f){var s=i(null);if(s.current===null){var l={hasValue:!1,value:null};s.current=l}else l=s.current;s=p(function(){function B(m){if(!C){if(C=!0,_=m,m=d(m),f!==void 0&&l.hasValue){var w=l.value;if(f(w,m))return h=w}return h=m}if(w=h,n(_,m))return w;var E=d(m);return f!==void 0&&f(w,E)?w:(_=m,h=E)}var C=!1,_,h,y=u===void 0?null:u;return[function(){return B(S())},y===null?void 0:function(){return B(y())}]},[S,u,d,f]);var v=o(c,s[0],s[1]);return a(function(){l.hasValue=!0,l.value=v},[v]),g(v),v},Ee}var ke={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ze;function or(){return Ze||(Ze=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=R,t=re;function r(S,u){return S===u&&(S!==0||1/S===1/u)||S!==S&&u!==u}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,p=e.useMemo,g=e.useDebugValue;function c(S,u,d,f,s){var l=i(null),v;l.current===null?(v={hasValue:!1,value:null},l.current=v):v=l.current;var B=p(function(){var y=!1,m,w,E=function(U){if(!y){y=!0,m=U;var ve=f(U);if(s!==void 0&&v.hasValue){var he=v.value;if(s(he,ve))return w=he,he}return w=ve,ve}var _t=m,me=w;if(n(_t,U))return me;var Se=f(U);return s!==void 0&&s(me,Se)?me:(m=U,w=Se,Se)},k=d===void 0?null:d,K=function(){return E(u())},pe=k===null?void 0:function(){return E(k())};return[K,pe]},[u,d,f,s]),C=B[0],_=B[1],h=o(S,C,_);return a(function(){v.hasValue=!0,v.value=h},[h]),g(h),h}ke.useSyncExternalStoreWithSelector=c,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),ke}(function(e){process.env.NODE_ENV==="production"?e.exports=ar():e.exports=or()})(Zt);function ir(e,t,r,n){let o=[jt.run({fn:i=>t(i)})];if(n&&o.unshift(n),r){let i=H({node:o}),a=e.graphite.id,p=r.additionalLinks,g=p[a]||[];return p[a]=g,g.push(i),()=>{let c=g.indexOf(i);c!==-1&&g.splice(c,1),Le(i)}}{let i=H({node:o,parent:[e],family:{owners:e}});return()=>{Le(i)}}}function sr(e,t){Pt.store(e)||gt("expect useStore argument to be a store");let r=R.useCallback(o=>ir(e,o,t),[e,t]),n=R.useCallback(()=>fr(e,t),[e,t]);return cr(r,n,n)}function lr(e){let t=R.useContext(dr);return e&&!t&&gt("No scope found, consider adding <Provider> to app root"),t}function ur(e,t){return sr(e,lr(t==null?void 0:t.forceScope))}let gt=e=>{throw Error(e)};typeof window<"u"?R.useLayoutEffect:R.useEffect;const{useSyncExternalStore:cr}=nr,fr=(e,t)=>t?t.getState(e):e.getState(),dr=R.createContext(null),pr=(e,t,r)=>{R.useEffect(()=>{const n=o=>{o instanceof KeyboardEvent&&o.key===r?t(o):r||t(o)};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)},[e,r,t])},et=(e,t,r,n)=>{R.useEffect(()=>(O.addEventListener(e,t,r),()=>O.removeEventListener(r)),[...n])},vr=(e,...t)=>{const{activeView:r,activePanel:n,activeModal:o,activePopout:i,isRouteInit:a}=wt();et("init",p=>{console.log("[blum]: initialized",p),a||(O.setDefaultBackHandlerOptions(),O.historyPush(e))},1,[a]),pr("popstate",async()=>{const p=async()=>{O.isDispatchChangeStateEventBeforeMiddleware&&O.dispatchChangeStateEvent();const{view:g,panel:c,modal:S,popout:u}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};console.log("prevRoutes",g,c,S,u),console.log("storeRoutes",r,n,o,i);for(const d in t)if(!await t[d]({view:r,panel:n,modal:o,popout:i},{view:g,panel:c,modal:S,popout:u}))return;O.isDispatchChangeStateEventAfterMiddleware&&O.dispatchChangeStateEvent()};a&&(O.beforeBackHandledCallback&&O.beforeBackHandledCallback(),await p(),O.isBackFromBrowser=!0,O.afterBackHandledCallback&&O.afterBackHandledCallback(),O.setDefaultBackHandlerOptions())}),et("changestate",p=>{if(console.log("[blum]: state changed",p),p){const{view:g,panel:c,modal:S,popout:u}=p;g&&c&&mt({view:g,panel:c}),Ne(S),$e(u),a||St()}},2,[a])},wt=()=>ur(Qt),hr=e=>e,mr=(e,t)=>yt(e,async(r,n)=>{let o;if(t&&(o=await t(r,n)),O.historyPush(r),typeof o=="boolean")return o}),yt=(e,t)=>async(r,n)=>{if(["view","panel","modal","popout"].some(i=>r[i]===e&&r[i]!==n[i])&&O.isBackFromBrowser){if(t){const i=await t(r,n);if(typeof i=="boolean")return i}return!1}return!0};exports._setActiveModal=Ne;exports._setActivePanel=ht;exports._setActivePopout=$e;exports._setActiveView=vt;exports.back=Et;exports.blumRouter=O;exports.createCatchBackBrowserRouteMiddleware=yt;exports.createDisableBackBrowserRouteMiddleware=mr;exports.createRouteMiddleware=hr;exports.setActiveModal=kt;exports.setActivePanel=bt;exports.setActivePopout=Bt;exports.setActiveViewPanel=Ot;exports.useInitRouter=vr;exports.useRouter=wt;
