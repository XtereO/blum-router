"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const R=require("react"),L={subscribers:[],historyPush(e,t){const{view:r,panel:n,modal:o,popout:l}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};this.changeState({view:e.hasOwnProperty("view")?e.view:r,panel:e.hasOwnProperty("panel")?e.panel:n,modal:e.hasOwnProperty("modal")?e.modal:o,popout:e.hasOwnProperty("popout")?e.popout:l,options:t})},changeState(e){try{window.history.pushState({view:e==null?void 0:e.view,panel:e==null?void 0:e.panel,modal:e==null?void 0:e.modal,popout:e==null?void 0:e.popout},""),this.dispatchChangeStateEvent(e==null?void 0:e.options)}catch(t){console.log("changeState err",t)}},dispatchChangeStateEvent(e){this._trigerEvent("changestate",{...window.history.state,options:e})},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r}),e==="changestate"&&this._trigerEvent("init",!0)},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}};function Bt(e,t){for(let r in e)t(e[r],r)}function M(e,t){e.forEach(t)}function j(e,t){if(!e)throw Error(t)}function x({node:e=[],from:t,source:r,parent:n=t||r,to:o,target:l,child:a=o||l,scope:f={},meta:_={},family:v={type:"regular"},regional:p}={}){let c=ie(n),d=ie(v.links),i=ie(v.owners),u=[];M(e,h=>h&&H(u,h));let s={id:Ht(),seq:u,next:ie(a),meta:_,scope:f,family:{type:v.type||"crosslink",links:d,owners:i}};return M(d,h=>H(ce(h),s)),M(i,h=>H(de(h),s)),M(c,h=>H(h.next,s)),p&&z&&ut(Q(z),[s]),s}function nt(e,t,r){let n,o=D,l=null,a=b;if(e.target&&(t=e.params,r=e.defer,n=e.meta,o="page"in e?e.page:o,e.stack&&(l=e.stack),a=ae(e)||a,e=e.target),a&&b&&a!==b&&(b=null),Array.isArray(e))for(let u=0;u<e.length;u++)V("pure",o,P(e[u]),l,t[u],a,n);else V("pure",o,P(e),l,t,a,n);if(r&&!oe)return;let f,_,v,p,c,d,i={isRoot:oe,currentPage:D,scope:b,isWatch:ye,isPure:se};oe=0;e:for(;p=Ft();){let{idx:u,stack:s,type:h}=p;v=s.node,D=c=s.page,b=ae(s),c?d=c.reg:b&&(d=b.reg);let B=!!c,O=!!b,E={fail:0,scope:v.scope};f=_=0;for(let m=u;m<v.seq.length&&!f;m++){let y=v.seq[m];if(y.order){let{priority:S,barrierID:w}=y.order,g=w?c?`${c.fullID}_${w}`:w:0;if(m!==u||h!==S){w?_e.has(g)||(_e.add(g),Ce(m,s,S,w)):Ce(m,s,S);continue e}w&&_e.delete(g)}switch(y.type){case"mov":{let w,g=y.data;switch(g.from){case Z:w=Q(s);break;case"a":case"b":w=s[g.from];break;case"value":w=g.store;break;case"store":if(d&&!d[g.store.id])if(B){let k=ft(c,g.store.id);s.page=c=k,k?d=k.reg:O?(F(b,g.store,0,1,g.softRead),d=b.reg):d=void 0}else O&&F(b,g.store,0,1,g.softRead);w=dt(d&&d[g.store.id]||g.store)}switch(g.to){case Z:s.value=w;break;case"a":case"b":s[g.to]=w;break;case"store":Gt(c,b,v,g.target).current=w}break}case"compute":let S=y.data;if(S.fn){ye=A(v,"op")==="watch",se=S.pure;let w=S.safe?(0,S.fn)(Q(s),E.scope,s):Ut(E,S.fn,s);S.filter?_=!w:s.value=w,ye=i.isWatch,se=i.isPure}}f=E.fail||_}if(!f){let m=Q(s),y=ae(s);if(M(v.next,S=>{V("child",c,S,s,m,y)}),y){A(v,"needFxCounter")&&V("child",c,y.fxCount,s,m,y),A(v,"storeChange")&&V("child",c,y.storeChange,s,m,y),A(v,"warnSerialize")&&V("child",c,y.warnSerializeNode,s,m,y);let S=y.additionalLinks[v.id];S&&M(S,w=>{V("child",c,w,s,m,y)})}}}oe=i.isRoot,D=i.currentPage,b=ae(i)}function Ct(e,t){let r,n,o=e;if(t){let l=Rt(t);e.length===0?(r=l.path,n=l.fullName):(r=l.path.concat([e]),n=l.fullName.length===0?e:l.fullName+"/"+e)}else r=e.length===0?[]:[e],n=e;return{shortName:o,fullName:n,path:r}}function J(e,...t){let r=lt();if(r){let n=r.handlers[e];if(n)return n(r,...t)}}function C(e,t){let r=re({or:t,and:typeof e=="string"?{name:e}:e}),n=(a,...f)=>(ee(!A(n,"derived"),"call of derived event","createEvent"),ee(!se,"unit call from pure function","operators like sample"),D?((_,v,p,c)=>{let d=D,i=null;if(v)for(i=D;i&&i.template!==v;)i=W(i);Je(i);let u=_.create(p,c);return Je(d),u})(n,o,a,f):n.create(a,f)),o=lt(),l=Object.assign(n,{graphite:x({meta:ht(r.actualOp||"event",n,r),regional:1}),create:a=>(nt({target:n,params:a,scope:b}),a),watch:a=>vt(n,a),map:a=>ge(n,X,a,[N()]),filter:a=>ge(n,"filter",a.fn?a:a.fn,[N(Te,1)]),filterMap:a=>ge(n,"filterMap",a,[N(),Be(f=>!I(f),1)]),prepend(a){let f=C("* → "+n.shortName,{parent:W(n)});return J("eventPrepend",P(f)),ze(f,n,[N()],"prepend",a),qt(n,f),f}});return r!=null&&r.domain&&r.domain.hooks.event(l),Y(l,"id",l.graphite.id),st(l.graphite),l}function Ge(e,t,r,n){return Tt(r,t,"first argument"),j(T(n),"second argument should be a function"),ee(!A(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),M(Array.isArray(r)?r:[r],o=>{e.off(o),ue(e).set(o,pt(mt(o,e,"on",It,n)))}),e}function at(e,t){let r=re(t),n=jt(e),o=C({named:"updates",derived:1});J("storeBase",n);let l=n.id,a={subscribers:new Map,updates:o,defaultState:e,stateRef:n,getState(){let i,u=n;if(D){let s=D;for(;s&&!s.reg[l];)s=W(s);s&&(i=s)}return!i&&b&&(F(b,n,1),i=b),i&&(u=i.reg[l]),dt(u)},setState:i=>nt({target:a,params:i,defer:1,scope:b}),reset:(...i)=>(M(i,u=>Ge(a,".reset",u,()=>a.defaultState)),a),on:(i,u)=>Ge(a,".on",i,u),off(i){let u=ue(a).get(i);return u&&(u(),ue(a).delete(i)),a},map(i,u){let s,h;G(i)&&(s=i,i=i.fn),ee(I(u),"second argument of store.map","updateFilter");let B=a.getState();I(B)||(h=i(B,u));let O=at(h,{name:`${a.shortName} → *`,derived:1,and:s}),E=mt(a,O,X,qe,i);return Wt(le(O),{type:X,fn:i,from:n}),le(O).noInit=1,J("storeMap",n,E),O},watch(i,u){if(!u||!He(i)){let s=vt(a,i);return J("storeWatch",n,i)||i(a.getState()),s}return j(T(u),"second argument should be a function"),i.watch(s=>u(a.getState(),s))}},f=ht("store",a,r),_=a.defaultConfig.updateFilter;a.graphite=x({scope:{state:n,fn:_},node:[Be((i,u,s)=>(s.scope&&!s.scope.reg[n.id]&&(s.b=1),i)),$t(n),Be((i,u,{a:s,b:h})=>!I(i)&&(i!==s||h),1),_&&N(qe,1),fe({from:Z,target:n})],child:o,meta:{...f,defaultState:e},regional:1}),Y(a,"id",a.graphite.id),Y(a,"rootStateRefId",l);let v=A(a,"serialize"),p=A(a,"derived"),c=v==="ignore",d=A(a,"sid");return d&&(Y(a,"storeChange",1),n.sid=d),d||c||p||Y(a,"warnSerialize",1),j(p||!I(e),"current state can't be undefined, use null instead"),ut(a,[o]),r!=null&&r.domain&&r.domain.hooks.store(a),p||(a.reinit=C({named:"reinit"}),a.reset(a.reinit)),n.meta=a.graphite.meta,st(a.graphite),a}let At=typeof Symbol<"u"&&Symbol.observable||"@@observable",X="map",Z="stack",P=e=>e.graphite||e,ce=e=>e.family.owners,de=e=>e.family.links,le=e=>e.stateRef,Q=e=>e.value,ue=e=>e.subscribers,W=e=>e.parent,ae=e=>e.scope,A=(e,t)=>P(e).meta[t],Y=(e,t,r)=>P(e).meta[t]=r,Rt=e=>e.compositeName,He=e=>(T(e)||G(e))&&"kind"in e;const ne=e=>t=>He(t)&&t.kind===e;let Ve=ne("store"),Mt=ne("event"),Ke=ne("effect"),it=ne("domain"),Lt=ne("scope");var Dt={__proto__:null,unit:He,store:Ve,event:Mt,effect:Ke,domain:it,scope:Lt,attached:e=>Ke(e)&&A(e,"attached")==1};let we=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},H=(e,t)=>e.push(t),ee=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const xe=()=>{let e=0;return()=>""+ ++e};let Pt=xe(),ot=xe(),Ht=xe(),z=null,st=e=>{},lt=()=>z,Vt=e=>(e&&z&&z.sidRoot&&(e=`${z.sidRoot}|${e}`),e),ut=(e,t)=>{let r=P(e);M(t,n=>{let o=P(n);r.family.type!=="domain"&&(o.family.type="crosslink"),H(ce(o),r),H(de(r),o)})},ie=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(P),G=e=>typeof e=="object"&&e!==null,T=e=>typeof e=="function",I=e=>e===void 0,xt=e=>j(G(e)||T(e),"expect first argument be an object");const Ue=(e,t,r,n)=>j(!(!G(e)&&!T(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${n}`);let Tt=(e,t,r)=>{Array.isArray(e)?M(e,(n,o)=>Ue(n,t,`${o} item of ${r}`,"")):Ue(e,t,r," or array of units")},qe=(e,{fn:t},{a:r})=>t(e,r),It=(e,{fn:t},{a:r})=>t(r,e),Te=(e,{fn:t})=>t(e);const ct=(e,t,r,n)=>{let o={id:ot(),type:e,data:t};return r&&(o.order={priority:r},n&&(o.order.barrierID=++Nt)),o};let Nt=0,fe=({from:e="store",store:t,target:r,to:n=r?"store":Z,batch:o,priority:l})=>ct("mov",{from:e,store:t,to:n,target:r},l,o),te=({fn:e,batch:t,priority:r,safe:n=0,filter:o=0,pure:l=0})=>ct("compute",{fn:e,safe:n,filter:o,pure:l},r,t),Ie=({fn:e})=>te({fn:e,priority:"effect"}),Be=(e,t,r)=>te({fn:e,safe:1,filter:t,priority:r&&"effect"}),$t=(e,t,r)=>fe({store:e,to:t?Z:"a",priority:r&&"sampler",batch:1}),N=(e=Te,t)=>te({fn:e,pure:1,filter:t}),zt={mov:fe,compute:te,filter:({fn:e,pure:t})=>te({fn:e,filter:1,pure:t}),run:Ie},jt=e=>({id:ot(),current:e}),dt=({current:e})=>e,Wt=(e,t)=>{e.before||(e.before=[]),H(e.before,t)},$=null;const Ne=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Ae(e.v.type)>Ae(t.v.type))&&(r=e,e=t,t=r),r=Ne(e.r,t),e.r=e.l,e.l=r,e},$e=[];let Ye=0;for(;Ye<6;)H($e,{first:null,last:null,size:0}),Ye+=1;const Ft=()=>{for(let e=0;e<6;e++){let t=$e[e];if(t.size>0){if(e===3||e===4){t.size-=1;let n=$.v;return $=Ne($.l,$.r),n}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},V=(e,t,r,n,o,l,a)=>Ce(0,{a:null,b:null,node:r,parent:n,value:o,page:t,scope:l,meta:a},e),Ce=(e,t,r,n=0)=>{let o=Ae(r),l=$e[o],a={v:{idx:e,stack:t,type:r,id:n},l:null,r:null};o===3||o===4?$=Ne($,a):(l.size===0?l.first=a:l.last.r=a,l.last=a),l.size+=1},Ae=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},_e=new Set;let b,oe=1,ye=0,se=0,D=null,Je=e=>{D=e};const ft=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=W(e);if(e)return e}return null};let Gt=(e,t,r,n,o)=>{let l=ft(e,n.id);return l?l.reg[n.id]:t?(F(t,n,o),t.reg[n.id]):n};const Kt=e=>e;let F=(e,t,r,n,o)=>{var l;let a=e.reg,f=t.sid,_=t==null||(l=t.meta)===null||l===void 0?void 0:l.serialize,v=e.fromSerialize&&_!=="ignore"&&(_==null?void 0:_.read)||Kt;if(a[t.id])return;let p={id:t.id,current:t.current,meta:t.meta};if(p.id in e.values.idMap)p.current=e.values.idMap[p.id];else if(f&&f in e.values.sidMap&&!(f in e.sidIdMap))p.current=v(e.values.sidMap[f]);else if(t.before&&!o){let c=0,d=r||!t.noInit||n;M(t.before,i=>{switch(i.type){case X:{let u=i.from;if(u||i.fn){u&&F(e,u,r,n);let s=u&&a[u.id].current;d&&(p.current=i.fn?i.fn(s):s)}break}case"field":c||(c=1,p.current=Array.isArray(p.current)?[...p.current]:{...p.current}),F(e,i.from,r,n),d&&(p.current[i.field]=a[a[i.from.id].id].current)}})}f&&(e.sidIdMap[f]=t.id),a[t.id]=p};const Ut=(e,t,r)=>{try{return t(Q(r),e.scope,r)}catch(n){console.error(n),e.fail=1,e.failReason=n}};let re=(e,t={})=>(G(e)&&(re(e.or,t),Bt(e,(r,n)=>{I(r)||n==="or"||n==="and"||(t[n]=r)}),re(e.and,t)),t);const Qe=(e,t)=>{we(e.next,t),we(ce(e),t),we(de(e),t)},Re=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let o=de(e);for(;n=o.pop();)Qe(n,e),(t||r&&A(e,"op")!=="sample"||n.family.type==="crosslink")&&Re(n,t,A(n,"op")!=="on"&&r);for(o=ce(e);n=o.pop();)Qe(n,e),r&&n.family.type==="crosslink"&&Re(n,t,A(n,"op")!=="on"&&r)},q=e=>e.clear();let Me=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),Ve(e))q(ue(e));else if(it(e)){r=1;let n=e.history;q(n.events),q(n.effects),q(n.stores),q(n.domains)}Re(P(e),!!t,r)},pt=e=>{let t=()=>Me(e);return t.unsubscribe=t,t},ze=(e,t,r,n,o)=>x({node:r,parent:e,child:t,scope:{fn:o},meta:{op:n},family:{owners:[e,t],links:t},regional:1}),vt=(e,t)=>(j(T(t),".watch argument should be a function"),pt(x({scope:{fn:t},node:[Ie({fn:Te})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),qt=(e,t,r="event")=>{W(e)&&W(e).hooks[r](t)},ht=(e,t,r)=>{let n=re(r),o=e==="domain",l=Pt(),{sid:a=null,named:f=null,domain:_=null,parent:v=_}=n,p=f||n.name||(o?"":l),c=Ct(p,v),d={op:t.kind=e,name:t.shortName=p,sid:t.sid=Vt(a),named:f,unitId:t.id=l,serialize:n.serialize,derived:n.derived,config:n};return t.parent=v,t.compositeName=c,t.defaultConfig=n,t.thru=i=>(ee(0,"thru","js pipe"),i(t)),t.getType=()=>c.fullName,!o&&(t.subscribe=i=>(xt(i),t.watch(T(i)?i:u=>i.next&&i.next(u))),t[At]=()=>t),d};const ge=(e,t,r,n)=>{let o;G(r)&&(o=r,r=r.fn);let l=C({name:`${e.shortName} → *`,derived:1,and:o});return ze(e,l,n,t,r),l},mt=(e,t,r,n,o)=>{let l=le(t),a=fe({store:l,to:"a",priority:"read"});r===X&&(a.data.softRead=1);let f=[a,N(n)];return J("storeOnMap",l,f,Ve(e)&&le(e)),ze(e,t,f,r,o)};x({node:[Ie({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}});const St=C(),wt=C(),_t=C(),je=C(),We=C(),yt=C(),gt=C(),Yt=C(),Le=C(),De=C(),Jt=e=>{e&&De({...e,isBackHandled:!1}),(!e||!e.hasOwnProperty("isBackFromBrowser"))&&De({isBackFromBrowser:!1}),window.history.back()},Qt=(e,t)=>{L.historyPush({view:e.view,panel:e.panel},t)},Xt=(e,t)=>{L.historyPush({panel:e},t)},Zt=(e,t)=>{L.historyPush({modal:e},t)},er=(e,t)=>{L.historyPush({popout:e},t)},tr=at({activeView:null,activePanel:null,activeModal:null,activePopout:null,routeOptions:null,isRouteInit:!1,isBackHandled:!0,isDispatchChangeStateEventBeforeMiddleware:!1,isDispatchChangeStateEventAfterMiddleware:!0,beforeBackHandledCallback:null,afterBackHandledCallback:null,isBackFromBrowser:!0}).on(Le,e=>({...e,isDispatchChangeStateEventBeforeMiddleware:!1,isDispatchChangeStateEventAfterMiddleware:!0,beforeBackHandledCallback:null,afterBackHandledCallback:null,isBackFromBrowser:!0,isBackHandled:!0})).on(De,(e,t)=>({...e,isBackHandled:t.hasOwnProperty("isBackHandled")?t.isBackHandled:e.isBackHandled,isBackFromBrowser:t.hasOwnProperty("isBackFromBrowser")?t.isBackFromBrowser:e.isBackFromBrowser,isDispatchChangeStateEventBeforeMiddleware:t.hasOwnProperty("isDispatchChangeStateEventBeforeMiddleware")?t.isDispatchChangeStateEventBeforeMiddleware:e.isDispatchChangeStateEventBeforeMiddleware,isDispatchChangeStateEventAfterMiddleware:t.hasOwnProperty("isDispatchChangeStateEventAfterMiddleware")?t.isDispatchChangeStateEventAfterMiddleware:e.isDispatchChangeStateEventAfterMiddleware,beforeBackHandledCallback:t.hasOwnProperty("beforeBackHandledCallback")?t.beforeBackHandledCallback:e.beforeBackHandledCallback,afterBackHandledCallback:t.hasOwnProperty("afterBackHandledCallback")?t.afterBackHandledCallback:e.afterBackHandledCallback})).on(St,(e,t)=>({...e,activeView:t})).on(wt,(e,t)=>({...e,activePanel:t})).on(je,(e,t)=>({...e,activeModal:t})).on(We,(e,t)=>({...e,activePopout:t})).on(yt,(e,t)=>({...e,routeOptions:t})).on(gt,e=>({...e,isRouteInit:!0})).on(_t,(e,{view:t,panel:r})=>({...e,activeView:t,activePanel:r})).on(Yt,(e,t)=>({...e,isBackHandled:t}));function rr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ee={},Pe={exports:{}},be={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe;function nr(){if(Xe)return be;Xe=1;var e=R;function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,o=e.useEffect,l=e.useLayoutEffect,a=e.useDebugValue;function f(c,d){var i=d(),u=n({inst:{value:i,getSnapshot:d}}),s=u[0].inst,h=u[1];return l(function(){s.value=i,s.getSnapshot=d,_(s)&&h({inst:s})},[c,i,d]),o(function(){return _(s)&&h({inst:s}),c(function(){_(s)&&h({inst:s})})},[c]),a(i),i}function _(c){var d=c.getSnapshot;c=c.value;try{var i=d();return!r(c,i)}catch{return!0}}function v(c,d){return d()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?v:f;return be.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,be}var Oe={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ze;function ar(){return Ze||(Ze=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=R,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(E){{for(var m=arguments.length,y=new Array(m>1?m-1:0),S=1;S<m;S++)y[S-1]=arguments[S];n("error",E,y)}}function n(E,m,y){{var S=t.ReactDebugCurrentFrame,w=S.getStackAddendum();w!==""&&(m+="%s",y=y.concat([w]));var g=y.map(function(k){return String(k)});g.unshift("Warning: "+m),Function.prototype.apply.call(console[E],console,g)}}function o(E,m){return E===m&&(E!==0||1/E===1/m)||E!==E&&m!==m}var l=typeof Object.is=="function"?Object.is:o,a=e.useState,f=e.useEffect,_=e.useLayoutEffect,v=e.useDebugValue,p=!1,c=!1;function d(E,m,y){p||e.startTransition!==void 0&&(p=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var S=m();if(!c){var w=m();l(S,w)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),c=!0)}var g=a({inst:{value:S,getSnapshot:m}}),k=g[0].inst,K=g[1];return _(function(){k.value=S,k.getSnapshot=m,i(k)&&K({inst:k})},[E,S,m]),f(function(){i(k)&&K({inst:k});var pe=function(){i(k)&&K({inst:k})};return E(pe)},[E]),v(S),S}function i(E){var m=E.getSnapshot,y=E.value;try{var S=m();return!l(y,S)}catch{return!0}}function u(E,m,y){return m()}var s=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",h=!s,B=h?u:d,O=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:B;Oe.useSyncExternalStore=O,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Oe}process.env.NODE_ENV==="production"?Pe.exports=nr():Pe.exports=ar();var Fe=Pe.exports;const ir=rr(Fe);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et;function or(){if(et)return Ee;et=1;var e=R,t=Fe;function r(v,p){return v===p&&(v!==0||1/v===1/p)||v!==v&&p!==p}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,l=e.useRef,a=e.useEffect,f=e.useMemo,_=e.useDebugValue;return Ee.useSyncExternalStoreWithSelector=function(v,p,c,d,i){var u=l(null);if(u.current===null){var s={hasValue:!1,value:null};u.current=s}else s=u.current;u=f(function(){function B(S){if(!O){if(O=!0,E=S,S=d(S),i!==void 0&&s.hasValue){var w=s.value;if(i(w,S))return m=w}return m=S}if(w=m,n(E,S))return w;var g=d(S);return i!==void 0&&i(w,g)?w:(E=S,m=g)}var O=!1,E,m,y=c===void 0?null:c;return[function(){return B(p())},y===null?void 0:function(){return B(y())}]},[p,c,d,i]);var h=o(v,u[0],u[1]);return a(function(){s.hasValue=!0,s.value=h},[h]),_(h),h},Ee}var ke={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tt;function sr(){return tt||(tt=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=R,t=Fe;function r(p,c){return p===c&&(p!==0||1/p===1/c)||p!==p&&c!==c}var n=typeof Object.is=="function"?Object.is:r,o=t.useSyncExternalStore,l=e.useRef,a=e.useEffect,f=e.useMemo,_=e.useDebugValue;function v(p,c,d,i,u){var s=l(null),h;s.current===null?(h={hasValue:!1,value:null},s.current=h):h=s.current;var B=f(function(){var y=!1,S,w,g=function(U){if(!y){y=!0,S=U;var ve=i(U);if(u!==void 0&&h.hasValue){var he=h.value;if(u(he,ve))return w=he,he}return w=ve,ve}var kt=S,me=w;if(n(kt,U))return me;var Se=i(U);return u!==void 0&&u(me,Se)?me:(S=U,w=Se,Se)},k=d===void 0?null:d,K=function(){return g(c())},pe=k===null?void 0:function(){return g(k())};return[K,pe]},[c,d,i,u]),O=B[0],E=B[1],m=o(p,O,E);return a(function(){h.hasValue=!0,h.value=m},[m]),_(m),m}ke.useSyncExternalStoreWithSelector=v,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),ke}process.env.NODE_ENV==="production"?or():sr();function lr(e,t,r,n){let o=[zt.run({fn:l=>t(l)})];if(n&&o.unshift(n),r){let l=x({node:o}),a=e.graphite.id,f=r.additionalLinks,_=f[a]||[];return f[a]=_,_.push(l),()=>{let v=_.indexOf(l);v!==-1&&_.splice(v,1),Me(l)}}{let l=x({node:o,parent:[e],family:{owners:e}});return()=>{Me(l)}}}function ur(e,t){Dt.store(e)||Et("expect useStore argument to be a store");let r=R.useCallback(o=>lr(e,o,t),[e,t]),n=R.useCallback(()=>pr(e,t),[e,t]);return fr(r,n,n)}function cr(e){let t=R.useContext(vr);return e&&!t&&Et("No scope found, consider adding <Provider> to app root"),t}function dr(e,t){return ur(e,cr(t==null?void 0:t.forceScope))}let Et=e=>{throw Error(e)};typeof window<"u"?R.useLayoutEffect:R.useEffect;const{useSyncExternalStore:fr}=ir,pr=(e,t)=>t?t.getState(e):e.getState(),vr=R.createContext(null),hr=(e,t,r)=>{R.useEffect(()=>{const n=o=>{o instanceof KeyboardEvent&&o.key===r?t(o):r||t(o)};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)},[e,r,t])},rt=(e,t,r,n)=>{R.useEffect(()=>(L.addEventListener(e,t,r),()=>L.removeEventListener(r)),[...n])},mr=(e,...t)=>{const{activeView:r,activePanel:n,activeModal:o,activePopout:l,isRouteInit:a,routeOptions:f,isDispatchChangeStateEventBeforeMiddleware:_,isDispatchChangeStateEventAfterMiddleware:v,isBackHandled:p,isBackFromBrowser:c,afterBackHandledCallback:d,beforeBackHandledCallback:i}=bt();rt("init",u=>{console.log("[blum]: initialized",u),a||(Le(),L.historyPush(e))},1,[a]),hr("popstate",async()=>{const u=async(s,h)=>{_&&L.dispatchChangeStateEvent();for(const B in t)if(!await t[B](s,h,{isBackHandled:p,isBackFromBrowser:c,isDispatchChangeStateEventAfterMiddleware:v,isDispatchChangeStateEventBeforeMiddleware:_,beforeBackHandledCallback:i,afterBackHandledCallback:d}))return;v&&L.dispatchChangeStateEvent()};if(a){const s=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0},h={view:r,panel:n,modal:o,popout:l};console.log("[blum]: prevRoutes",s),console.log("[blum]: storeRoutes",h),i&&i(h,s),await u(h,s),Le(),d&&d(h,s)}}),rt("changestate",u=>{if(console.log("[blum]: state changed",u),u){const{view:s,panel:h,modal:B,popout:O}=u;s&&h&&_t({view:s,panel:h}),je(B),We(O),yt((u==null?void 0:u.options)??null),a||gt()}},2,[a]),R.useEffect(()=>{f&&f!=null&&f.afterSetHandledCallback&&f.afterSetHandledCallback()},[f])},bt=()=>dr(tr),Sr=e=>e,wr=(e,t)=>Ot(e,async(r,n,o)=>{let l;if(t&&(l=await t(r,n,o)),L.historyPush(r),typeof l=="boolean")return l}),Ot=(e,t)=>async(r,n,o)=>{if(["view","panel","modal","popout"].some(a=>r[a]===e&&r[a]!==n[a])&&o.isBackFromBrowser){if(t){const a=await t(r,n,o);if(typeof a=="boolean")return a}return!1}return!0};exports._setActiveModal=je;exports._setActivePanel=wt;exports._setActivePopout=We;exports._setActiveView=St;exports.back=Jt;exports.blumRouter=L;exports.createCatchBackBrowserRouteMiddleware=Ot;exports.createDisableBackBrowserRouteMiddleware=wr;exports.createRouteMiddleware=Sr;exports.setActiveModal=Zt;exports.setActivePanel=Xt;exports.setActivePopout=er;exports.setActiveViewPanel=Qt;exports.useInitRouter=mr;exports.useRouter=bt;
