"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const k=require("react"),ve={subscribers:[],changeState(e){try{window.history.pushState(e,""),this.fireChangeStateEvent()}catch(t){console.log("changeState err",t)}},fireChangeStateEvent(){this._trigerEvent("changestate",window.history.state)},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r})},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}};function bt(e,t){for(let r in e)t(e[r],r)}function V(e,t){e.forEach(t)}function I(e,t){if(!e)throw Error(t)}function B({node:e=[],from:t,source:r,parent:n=t||r,to:a,target:l,child:o=a||l,scope:v={},meta:_={},family:f={type:"regular"},regional:m}={}){let c=le(n),p=le(f.links),i=le(f.owners),s=[];V(e,d=>d&&C(s,d));let u={id:Dt(),seq:s,next:le(o),meta:_,scope:v,family:{type:f.type||"crosslink",links:p,owners:i}};return V(p,d=>C(ge(d),u)),V(i,d=>C(Se(d),u)),V(c,d=>C(d.next,u)),m&&H&&Ne(ee(H),[u]),u}function re(e,t,r){let n,a=D,l=null,o=O;if(e.target&&(t=e.params,r=e.defer,n=e.meta,a="page"in e?e.page:a,e.stack&&(l=e.stack),o=P(e)||o,e=e.target),o&&O&&o!==O&&(O=null),Array.isArray(e))for(let s=0;s<e.length;s++)$("pure",a,T(e[s]),l,t[s],o,n);else $("pure",a,T(e),l,t,o,n);if(r&&!ce)return;let v,_,f,m,c,p,i={isRoot:ce,currentPage:D,scope:O,isWatch:de,isPure:pe};ce=0;e:for(;m=Gt();){let{idx:s,stack:u,type:d}=m;f=u.node,D=c=u.page,O=P(u),c?p=c.reg:O&&(p=O.reg);let b=!!c,A=!!O,w={fail:0,scope:f.scope};v=_=0;for(let h=s;h<f.seq.length&&!v;h++){let y=f.seq[h];if(y.order){let{priority:g,barrierID:S}=y.order,E=S?c?`${c.fullID}_${S}`:S:0;if(h!==s||d!==g){S?Re.has(E)||(Re.add(E),Ce(h,u,g,S)):Ce(h,u,g);continue e}S&&Re.delete(E)}switch(y.type){case"mov":{let S,E=y.data;switch(E.from){case oe:S=ee(u);break;case"a":case"b":S=u[E.from];break;case"value":S=E.store;break;case"store":if(p&&!p[E.store.id])if(b){let R=dt(c,E.store.id);u.page=c=R,R?p=R.reg:A?(K(O,E.store,0,1,E.softRead),p=O.reg):p=void 0}else A&&K(O,E.store,0,1,E.softRead);S=ft(p&&p[E.store.id]||E.store)}switch(E.to){case oe:u.value=S;break;case"a":case"b":u[E.to]=S;break;case"store":Ft(c,O,f,E.target).current=S}break}case"compute":let g=y.data;if(g.fn){de=L(f,"op")==="watch",pe=g.pure;let S=g.safe?(0,g.fn)(ee(u),w.scope,u):Ut(w,g.fn,u);g.filter?_=!S:u.value=S,de=i.isWatch,pe=i.isPure}}v=w.fail||_}if(!v){let h=ee(u),y=P(u);if(V(f.next,g=>{$("child",c,g,u,h,y)}),y){L(f,"needFxCounter")&&$("child",c,y.fxCount,u,h,y),L(f,"storeChange")&&$("child",c,y.storeChange,u,h,y),L(f,"warnSerialize")&&$("child",c,y.warnSerializeNode,u,h,y);let g=y.additionalLinks[f.id];g&&V(g,S=>{$("child",c,S,u,h,y)})}}}ce=i.isRoot,D=i.currentPage,O=P(i)}function At(e,t){let r,n,a=e;if(t){let l=kt(t);e.length===0?(r=l.path,n=l.fullName):(r=l.path.concat([e]),n=l.fullName.length===0?e:l.fullName+"/"+e)}else r=e.length===0?[]:[e],n=e;return{shortName:a,fullName:n,path:r}}function Z(e,...t){let r=lt();if(r){let n=r.handlers[e];if(n)return n(r,...t)}}function x(e,t){let r=U({or:t,and:typeof e=="string"?{name:e}:e}),n=(o,...v)=>(ae(!L(n,"derived"),"call of derived event","createEvent"),ae(!pe,"unit call from pure function","operators like sample"),D?((_,f,m,c)=>{let p=D,i=null;if(f)for(i=D;i&&i.template!==f;)i=N(i);Xe(i);let s=_.create(m,c);return Xe(p),s})(n,a,o,v):n.create(o,v)),a=lt(),l=Object.assign(n,{graphite:B({meta:ht("event",n,r),regional:1}),create:o=>(re({target:n,params:o,scope:O}),o),watch:o=>vt(n,o),map:o=>Le(n,ne,o,[W()]),filter:o=>Le(n,"filter",o.fn?o:o.fn,[W(je,1)]),filterMap:o=>Le(n,"filterMap",o,[W(),F(v=>!q(v),1)]),prepend(o){let v=x("* → "+n.shortName,{parent:N(n)});return Z("eventPrepend",T(v)),Ge(v,n,[W()],"prepend",o),Yt(n,v),v}});return r!=null&&r.domain&&r.domain.hooks.event(l),l}function Ke(e,t,r,n){return Bt(r,t,"first argument"),I(M(n),"second argument should be a function"),ae(!L(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),V(Array.isArray(r)?r:[r],a=>{e.off(a),me(e).set(a,pt(mt(a,e,"on",$t,n)))}),e}function Ie(e,t){let r=U(t),n=qt(e),a=x({named:"updates",derived:1});Z("storeBase",n);let l=n.id,o={subscribers:new Map,updates:a,defaultState:e,stateRef:n,getState(){let s,u=n;if(D){let d=D;for(;d&&!d.reg[l];)d=N(d);d&&(s=d)}return!s&&O&&(K(O,n,1),s=O),s&&(u=s.reg[l]),ft(u)},setState:s=>re({target:o,params:s,defer:1,scope:O}),reset:(...s)=>(V(s,u=>Ke(o,".reset",u,()=>o.defaultState)),o),on:(s,u)=>Ke(o,".on",s,u),off(s){let u=me(o).get(s);return u&&(u(),me(o).delete(s)),o},map(s,u){let d,b;j(s)&&(d=s,s=s.fn),ae(q(u),"second argument of store.map","updateFilter");let A=o.getState();q(A)||(b=s(A,u));let w=Ie(b,{name:`${o.shortName} → *`,derived:1,and:d}),h=mt(o,w,ne,Je,s);return Wt(he(w),{type:ne,fn:s,from:n}),he(w).noInit=1,Z("storeMap",n,h),w},watch(s,u){if(!u||!Be(s)){let d=vt(o,s);return Z("storeWatch",n,s)||s(o.getState()),d}return I(M(u),"second argument should be a function"),s.watch(d=>u(o.getState(),d))}},v=ht("store",o,r),_=o.defaultConfig.updateFilter;o.graphite=B({scope:{state:n,fn:_},node:[F((s,u,d)=>(d.scope&&!d.scope.reg[n.id]&&(d.b=1),s)),jt(n),F((s,u,{a:d,b})=>!q(s)&&(s!==d||b),1),_&&W(Je,1),ye({from:oe,target:n})],child:a,meta:v,regional:1});let f=L(o,"serialize"),m=L(o,"derived"),c=f==="ignore",p=!f||c?0:f,i=L(o,"sid");return i&&(c||te(o,"storeChange",1),n.sid=i,p&&(n.meta={...n==null?void 0:n.meta,serialize:p})),i||c||m||te(o,"warnSerialize",1),I(m||!q(e),"current state can't be undefined, use null instead"),Ne(o,[a]),r!=null&&r.domain&&r.domain.hooks.store(o),m||(o.reinit=x(),o.reset(o.reinit)),o}function Rt(){let e={};return e.req=new Promise((t,r)=>{e.rs=t,e.rj=r}),e.req.catch(()=>{}),e}function Y(e,t){let r=U(M(e)?{handler:e}:e,t),n=x(M(e)?{handler:e}:e,t),a=T(n);te(a,"op",n.kind="effect"),n.use=i=>(I(M(i),".use argument should be a function"),m.scope.handler=i,n),n.use.getCurrent=()=>m.scope.handler;let l=n.finally=x({named:"finally",derived:1}),o=n.done=l.filterMap({named:"done",fn({status:i,params:s,result:u}){if(i==="done")return{params:s,result:u}}}),v=n.fail=l.filterMap({named:"fail",fn({status:i,params:s,error:u}){if(i==="fail")return{params:s,error:u}}}),_=n.doneData=o.map({named:"doneData",fn:({result:i})=>i}),f=n.failData=v.map({named:"failData",fn:({error:i})=>i}),m=B({scope:{handlerId:L(a,"sid"),handler:n.defaultConfig.handler||(()=>I(0,`no handler used in ${n.getType()}`))},node:[F((i,s,u)=>{let d=s,b=d.handler;if(P(u)){let A=P(u).handlers[d.handlerId];A&&(b=A)}return i.handler=b,i},0,1),F(({params:i,req:s,handler:u,args:d=[i]},b,A)=>{let w=Qt(A),h=et(i,s,1,l,A,w),y=et(i,s,0,l,A,w),[g,S]=Jt(u,y,d);g&&(j(S)&&M(S.then)?S.then(h,y):h(S))},0,1)],meta:{op:"fx",fx:"runner"}});a.scope.runner=m,C(a.seq,F((i,{runner:s},u)=>{let d=N(u)?{params:i,req:{rs(b){},rj(b){}}}:i;return u.meta||(u.meta={fxID:Tt()}),re({target:s,params:d,defer:1,scope:P(u),meta:u.meta}),d.params},0,1)),n.create=i=>{let s=Rt(),u={params:i,req:s};if(O&&!de){let d=O;s.req.finally(()=>{Ht(d)}).catch(()=>{})}return re({target:n,params:u,scope:O}),s.req};let c=n.inFlight=Ie(0,{serialize:"ignore"}).on(n,i=>i+1).on(l,i=>i-1).map({fn:i=>i,named:"inFlight"});te(l,"needFxCounter","dec"),te(n,"needFxCounter",1);let p=n.pending=c.map({fn:i=>i>0,named:"pending"});return Ne(n,[l,o,v,_,f,p,c]),r!=null&&r.domain&&r.domain.hooks.effect(n),n}let Lt=typeof Symbol<"u"&&Symbol.observable||"@@observable",ne="map",oe="stack",T=e=>e.graphite||e,ge=e=>e.family.owners,Se=e=>e.family.links,he=e=>e.stateRef,ee=e=>e.value,me=e=>e.subscribers,N=e=>e.parent,P=e=>e.scope,L=(e,t)=>T(e).meta[t],te=(e,t,r)=>T(e).meta[t]=r,kt=e=>e.compositeName,Be=e=>(M(e)||j(e))&&"kind"in e;const ue=e=>t=>Be(t)&&t.kind===e;let $e=ue("store"),xt=ue("event"),Ue=ue("effect"),st=ue("domain"),Vt=ue("scope");var Mt={__proto__:null,unit:Be,store:$e,event:xt,effect:Ue,domain:st,scope:Vt,attached:e=>Ue(e)&&L(e,"attached")==1};let fe=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},C=(e,t)=>e.push(t),ae=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const _e=()=>{let e=0;return()=>""+ ++e};let Ct=_e(),ut=_e(),Dt=_e(),Tt=_e(),H=null,lt=()=>H,Pt=e=>(e&&H&&H.sidRoot&&(e=`${H.sidRoot}|${e}`),e),Ne=(e,t)=>{let r=T(e);V(t,n=>{let a=T(n);r.family.type!=="domain"&&(a.family.type="crosslink"),C(ge(a),r),C(Se(r),a)})},le=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(T),j=e=>typeof e=="object"&&e!==null,M=e=>typeof e=="function",q=e=>e===void 0,It=e=>I(j(e)||M(e),"expect first argument be an object");const Ye=(e,t,r,n)=>I(!(!j(e)&&!M(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${n}`);let Bt=(e,t,r)=>{Array.isArray(e)?V(e,(n,a)=>Ye(n,t,`${a} item of ${r}`,"")):Ye(e,t,r," or array of units")},Je=(e,{fn:t},{a:r})=>t(e,r),$t=(e,{fn:t},{a:r})=>t(r,e),je=(e,{fn:t})=>t(e);const ct=(e,t,r,n)=>{let a={id:ut(),type:e,data:t};return r&&(a.order={priority:r},n&&(a.order.barrierID=++Nt)),a};let Nt=0,ye=({from:e="store",store:t,target:r,to:n=r?"store":oe,batch:a,priority:l})=>ct("mov",{from:e,store:t,to:n,target:r},l,a),ie=({fn:e,batch:t,priority:r,safe:n=0,filter:a=0,pure:l=0})=>ct("compute",{fn:e,safe:n,filter:a,pure:l},r,t),ze=({fn:e})=>ie({fn:e,priority:"effect"}),F=(e,t,r)=>ie({fn:e,safe:1,filter:t,priority:r&&"effect"}),jt=(e,t,r)=>ye({store:e,to:t?oe:"a",priority:r&&"sampler",batch:1}),W=(e=je,t)=>ie({fn:e,pure:1,filter:t}),zt={mov:ye,compute:ie,filter:({fn:e,pure:t})=>ie({fn:e,filter:1,pure:t}),run:ze},qt=e=>({id:ut(),current:e}),ft=({current:e})=>e,Wt=(e,t)=>{e.before||(e.before=[]),C(e.before,t)},G=null;const qe=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||De(e.v.type)>De(t.v.type))&&(r=e,e=t,t=r),r=qe(e.r,t),e.r=e.l,e.l=r,e},We=[];let Qe=0;for(;Qe<6;)C(We,{first:null,last:null,size:0}),Qe+=1;const Gt=()=>{for(let e=0;e<6;e++){let t=We[e];if(t.size>0){if(e===3||e===4){t.size-=1;let n=G.v;return G=qe(G.l,G.r),n}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},$=(e,t,r,n,a,l,o)=>Ce(0,{a:null,b:null,node:r,parent:n,value:a,page:t,scope:l,meta:o},e),Ce=(e,t,r,n=0)=>{let a=De(r),l=We[a],o={v:{idx:e,stack:t,type:r,id:n},l:null,r:null};a===3||a===4?G=qe(G,o):(l.size===0?l.first=o:l.last.r=o,l.last=o),l.size+=1},De=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},Re=new Set;let O,ce=1,de=0,pe=0,D=null,Ht=e=>{O=e},Xe=e=>{D=e};const dt=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=N(e);if(e)return e}return null};let Ft=(e,t,r,n,a)=>{let l=dt(e,n.id);return l?l.reg[n.id]:t?(K(t,n,a),t.reg[n.id]):n};const Kt=e=>e;let K=(e,t,r,n,a)=>{var l;let o=e.reg,v=t.sid,_=t==null||(l=t.meta)===null||l===void 0?void 0:l.serialize;if(o[t.id])return;let f={id:t.id,current:t.current,meta:t.meta};if(v&&v in e.sidValuesMap&&!(v in e.sidIdMap))f.current=(e.fromSerialize&&_!=="ignore"&&(_==null?void 0:_.read)||Kt)(e.sidValuesMap[v]);else if(t.before&&!a){let m=0,c=r||!t.noInit||n;V(t.before,p=>{switch(p.type){case ne:{let i=p.from;if(i||p.fn){i&&K(e,i,r,n);let s=i&&o[i.id].current;c&&(f.current=p.fn?p.fn(s):s)}break}case"field":m||(m=1,f.current=Array.isArray(f.current)?[...f.current]:{...f.current}),K(e,p.from,r,n),c&&(f.current[p.field]=o[o[p.from.id].id].current)}})}v&&(e.sidIdMap[v]=t.id),o[t.id]=f};const Ut=(e,t,r)=>{try{return t(ee(r),e.scope,r)}catch(n){console.error(n),e.fail=1}};let U=(e,t={})=>(j(e)&&(U(e.or,t),bt(e,(r,n)=>{q(r)||n==="or"||n==="and"||(t[n]=r)}),U(e.and,t)),t);const Ze=(e,t)=>{fe(e.next,t),fe(ge(e),t),fe(Se(e),t)},Te=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let a=Se(e);for(;n=a.pop();)Ze(n,e),(t||r&&L(e,"op")!=="sample"||n.family.type==="crosslink")&&Te(n,t,L(n,"op")!=="on"&&r);for(a=ge(e);n=a.pop();)Ze(n,e),r&&n.family.type==="crosslink"&&Te(n,t,L(n,"op")!=="on"&&r)},X=e=>e.clear();let Pe=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),$e(e))X(me(e));else if(st(e)){r=1;let n=e.history;X(n.events),X(n.effects),X(n.stores),X(n.domains)}Te(T(e),!!t,r)},pt=e=>{let t=()=>Pe(e);return t.unsubscribe=t,t},Ge=(e,t,r,n,a)=>B({node:r,parent:e,child:t,scope:{fn:a},meta:{op:n},family:{owners:[e,t],links:t},regional:1}),vt=(e,t)=>(I(M(t),".watch argument should be a function"),pt(B({scope:{fn:t},node:[ze({fn:je})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),Yt=(e,t,r="event")=>{N(e)&&N(e).hooks[r](t)},ht=(e,t,r)=>{let n=U(r),a=e==="domain",l=Ct(),{sid:o=null,named:v=null,domain:_=null,parent:f=_}=n,m=v||n.name||(a?"":l),c=At(m,f),p={op:t.kind=e,name:t.shortName=m,sid:t.sid=Pt(o),named:v,unitId:t.id=l,serialize:n.serialize,derived:n.derived,config:n};return t.parent=f,t.compositeName=c,t.defaultConfig=n,t.thru=i=>(ae(0,"thru","js pipe"),i(t)),t.getType=()=>c.fullName,!a&&(t.subscribe=i=>(It(i),t.watch(M(i)?i:s=>i.next&&i.next(s))),t[Lt]=()=>t),p};const Le=(e,t,r,n)=>{let a;j(r)&&(a=r,r=r.fn);let l=x({name:`${e.shortName} → *`,derived:1,and:a});return Ge(e,l,n,t,r),l},mt=(e,t,r,n,a)=>{let l=he(t),o=ye({store:l,to:"a",priority:"read"});r===ne&&(o.data.softRead=1);let v=[o,W(n)];return Z("storeOnMap",l,v,$e(e)&&he(e)),Ge(e,t,v,r,a)};let Jt=(e,t,r)=>{try{return[1,e(...r)]}catch(n){return t(n),[0,null]}},Qt=e=>{let t=P(e),r={ref:t};return t&&C(t.activeEffects,r),r},et=(e,t,r,n,a,l)=>o=>{l.ref&&fe(l.ref.activeEffects,l),re({target:[n,Xt],params:[r?{status:"done",params:e,result:o}:{status:"fail",params:e,error:o},{value:o,fn:r?t.rs:t.rj}],defer:1,page:a.page,scope:l.ref,meta:a.meta})};const Xt=B({node:[ze({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}}),tt={subscribers:[],changeState(e){try{window.history.pushState(e,""),this.fireChangeStateEvent()}catch(t){console.log("changeState err",t)}},fireChangeStateEvent(){this._trigerEvent("changestate",window.history.state)},addEventListener(e,t,r){this.subscribers.push({type:e,callback:t,index:r})},removeEventListener(e){this.subscribers=this.subscribers.filter(t=>t.index!==e)},_trigerEvent(e,t){this.subscribers.forEach(r=>r.type===e&&r.callback(t))}},Zt=Y(()=>{window.isBackFromBrowser=!1,window.history.back()}),z=Y(e=>{const{view:t,panel:r,modal:n,popout:a}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};console.log("try to push history",tt.subscribers),tt.changeState({view:e.hasOwnProperty("view")?e.view:t,panel:e.hasOwnProperty("panel")?e.panel:r,modal:e.hasOwnProperty("modal")?e.modal:n,popout:e.hasOwnProperty("popout")?e.popout:a})}),er=Y(e=>{z({view:e.view,panel:e.panel})}),tr=Y(e=>{z({panel:e})}),rr=Y(e=>{z({modal:e})}),nr=Y(e=>{z({popout:e})}),gt=x(),St=x(),_t=x(),He=x(),Fe=x(),yt=x(),or=x(),ar=Ie({activeView:null,activePanel:null,activeModal:null,activePopout:null,isRouteInit:!1,isBackHandled:!0}).on(gt,(e,t)=>({...e,activeView:t})).on(St,(e,t)=>({...e,activePanel:t})).on(He,(e,t)=>({...e,activeModal:t})).on(Fe,(e,t)=>({...e,activePopout:t})).on(yt,e=>({...e,isRouteInit:!0})).on(_t,(e,{view:t,panel:r})=>({...e,activeView:t,activePanel:r})).on(or,(e,t)=>({...e,isBackHandled:t}));function ir(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rt={},sr={get exports(){return rt},set exports(e){rt=e}},ke={},se={},ur={get exports(){return se},set exports(e){se=e}},xe={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nt;function lr(){if(nt)return xe;nt=1;var e=k;function t(c,p){return c===p&&(c!==0||1/c===1/p)||c!==c&&p!==p}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,l=e.useLayoutEffect,o=e.useDebugValue;function v(c,p){var i=p(),s=n({inst:{value:i,getSnapshot:p}}),u=s[0].inst,d=s[1];return l(function(){u.value=i,u.getSnapshot=p,_(u)&&d({inst:u})},[c,i,p]),a(function(){return _(u)&&d({inst:u}),c(function(){_(u)&&d({inst:u})})},[c]),o(i),i}function _(c){var p=c.getSnapshot;c=c.value;try{var i=p();return!r(c,i)}catch{return!0}}function f(c,p){return p()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:v;return xe.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:m,xe}var Ve={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ot;function cr(){return ot||(ot=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=k,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(w){{for(var h=arguments.length,y=new Array(h>1?h-1:0),g=1;g<h;g++)y[g-1]=arguments[g];n("error",w,y)}}function n(w,h,y){{var g=t.ReactDebugCurrentFrame,S=g.getStackAddendum();S!==""&&(h+="%s",y=y.concat([S]));var E=y.map(function(R){return String(R)});E.unshift("Warning: "+h),Function.prototype.apply.call(console[w],console,E)}}function a(w,h){return w===h&&(w!==0||1/w===1/h)||w!==w&&h!==h}var l=typeof Object.is=="function"?Object.is:a,o=e.useState,v=e.useEffect,_=e.useLayoutEffect,f=e.useDebugValue,m=!1,c=!1;function p(w,h,y){m||e.startTransition!==void 0&&(m=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var g=h();if(!c){var S=h();l(g,S)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),c=!0)}var E=o({inst:{value:g,getSnapshot:h}}),R=E[0].inst,J=E[1];return _(function(){R.value=g,R.getSnapshot=h,i(R)&&J({inst:R})},[w,g,h]),v(function(){i(R)&&J({inst:R});var we=function(){i(R)&&J({inst:R})};return w(we)},[w]),f(g),g}function i(w){var h=w.getSnapshot,y=w.value;try{var g=h();return!l(y,g)}catch{return!0}}function s(w,h,y){return h()}var u=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",d=!u,b=d?s:p,A=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:b;Ve.useSyncExternalStore=A,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Ve}(function(e){process.env.NODE_ENV==="production"?e.exports=lr():e.exports=cr()})(ur);const fr=ir(se);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var at;function dr(){if(at)return ke;at=1;var e=k,t=se;function r(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,l=e.useRef,o=e.useEffect,v=e.useMemo,_=e.useDebugValue;return ke.useSyncExternalStoreWithSelector=function(f,m,c,p,i){var s=l(null);if(s.current===null){var u={hasValue:!1,value:null};s.current=u}else u=s.current;s=v(function(){function b(g){if(!A){if(A=!0,w=g,g=p(g),i!==void 0&&u.hasValue){var S=u.value;if(i(S,g))return h=S}return h=g}if(S=h,n(w,g))return S;var E=p(g);return i!==void 0&&i(S,E)?S:(w=g,h=E)}var A=!1,w,h,y=c===void 0?null:c;return[function(){return b(m())},y===null?void 0:function(){return b(y())}]},[m,c,p,i]);var d=a(f,s[0],s[1]);return o(function(){u.hasValue=!0,u.value=d},[d]),_(d),d},ke}var Me={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var it;function pr(){return it||(it=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=k,t=se;function r(m,c){return m===c&&(m!==0||1/m===1/c)||m!==m&&c!==c}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,l=e.useRef,o=e.useEffect,v=e.useMemo,_=e.useDebugValue;function f(m,c,p,i,s){var u=l(null),d;u.current===null?(d={hasValue:!1,value:null},u.current=d):d=u.current;var b=v(function(){var y=!1,g,S,E=function(Q){if(!y){y=!0,g=Q;var Ee=i(Q);if(s!==void 0&&d.hasValue){var Oe=d.value;if(s(Oe,Ee))return S=Oe,Oe}return S=Ee,Ee}var Ot=g,be=S;if(n(Ot,Q))return be;var Ae=i(Q);return s!==void 0&&s(be,Ae)?be:(g=Q,S=Ae,Ae)},R=p===void 0?null:p,J=function(){return E(c())},we=R===null?void 0:function(){return E(R())};return[J,we]},[c,p,i,s]),A=b[0],w=b[1],h=a(m,A,w);return o(function(){d.hasValue=!0,d.value=h},[h]),_(h),h}Me.useSyncExternalStoreWithSelector=f,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Me}(function(e){process.env.NODE_ENV==="production"?e.exports=dr():e.exports=pr()})(sr);function vr(e,t,r,n){let a=[zt.run({fn:l=>t(l)})];if(n&&a.unshift(n),r){let l=B({node:a}),o=e.graphite.id,v=r.additionalLinks,_=v[o]||[];return v[o]=_,_.push(l),()=>{let f=_.indexOf(l);f!==-1&&_.splice(f,1),Pe(l)}}{let l=B({node:a,parent:[e],family:{owners:e}});return()=>{Pe(l)}}}function hr(e,t){Mt.store(e)||wt("expect useStore argument to be a store");let r=k.useCallback(a=>vr(e,a,t),[e,t]),n=k.useCallback(()=>_r(e,t),[e,t]);return Sr(r,n,n)}function mr(e){let t=k.useContext(yr);return e&&!t&&wt("No scope found, consider adding <Provider> to app root"),t}function gr(e,t){return hr(e,mr(t==null?void 0:t.forceScope))}let wt=e=>{throw Error(e)};typeof window<"u"?k.useLayoutEffect:k.useEffect;const{useSyncExternalStore:Sr}=fr,_r=(e,t)=>t?t.getState(e):e.getState(),yr=k.createContext(null),wr=(e,t,r)=>{k.useEffect(()=>{const n=a=>{a instanceof KeyboardEvent&&a.key===r?t(a):r||t(a)};return window.addEventListener(e,n),()=>window.removeEventListener(e,n)},[e,r,t])},Er=(e,t,r)=>{k.useEffect(()=>(ve.addEventListener(e,t,r),()=>ve.removeEventListener(r)),[e,r,t])},Or=(e,...t)=>{Er("changestate",v=>{if(console.log("[blum]: state changed",v),v){const{view:_,panel:f,modal:m,popout:c}=v;_&&f&&_t({view:_,panel:f}),He(m),Fe(c),o||yt()}},1);const{activeView:r,activePanel:n,activeModal:a,activePopout:l,isRouteInit:o}=Et();k.useEffect(()=>{o||z(e)},[o,e]),wr("popstate",async()=>{o&&(await(async()=>{ve.fireChangeStateEvent();const{view:_,panel:f,modal:m,popout:c}=window.history.state??{view:void 0,panel:void 0,modal:void 0,popout:void 0};console.log("prevRoutes",_,f,m,c),console.log("storeRoutes",r,n,a,l);for(const p in t)if(!await t[p]({view:r,panel:n,modal:a,popout:l},{view:_,panel:f,modal:m,popout:c}))return})(),window.isBackFromBrowser=!0)})},Et=()=>gr(ar),br=e=>e,Ar=(e,t)=>(r,n)=>["view","panel","modal","popout"].some(l=>r[l]===e&&r[l]!==n[l])&&window.isBackFromBrowser?(t&&t(r,n),z(r),!1):!0;exports._setActiveModal=He;exports._setActivePanel=St;exports._setActivePopout=Fe;exports._setActiveView=gt;exports.back=Zt;exports.blumRouter=ve;exports.createDisableBackBrowserRouteMiddleware=Ar;exports.createRouteMiddleware=br;exports.historyPush=z;exports.setActiveModal=rr;exports.setActivePanel=tr;exports.setActivePopout=nr;exports.setActiveViewPanel=er;exports.useInitRouter=Or;exports.useRouter=Et;
